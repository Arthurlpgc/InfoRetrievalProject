<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>D: Restoring Road Network
 - AtCoder Beginner Contest 074 | AtCoder</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="
">
    <meta name="keyword" content="AtCoder,アットコーダー,あっとこーだー,プログラミングコンテスト
">
    <meta name="author" content="Atcoder" />
    <meta name="copyright" content="Copyright (C) 2012 Atcoder" />
    <meta name="format-detection" content="telephone=no" />

    <link rel="stylesheet" type="text/css" href="/css/all.css?v=2">
    <link rel="stylesheet" type="text/css" href="/css/print.css?v=1" media="print">
        <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <script src="/js/jquery.js"></script>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30554866-3']);
  _gaq.push(['_setDomainName', 'atcoder.jp']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>    
    <!--[if lt IE 9]><style>.navbar-fixed-top{ position: relative!important; }</style><![endif]-->

  </head>


  <body>
          <div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
              <a class="brand" href="/"><span class="contest-name">AtCoder Beginner Contest 074</span><span class="bland-small"><time>2017/09/16 12:00:00 +0000</time> ~ <time>2017/09/16 13:40:00 +0000</time></span></a>
      
      <div class="nav-collapse">
                <ul class="nav">
          <li class="divider-vertical"></li>
          <li><a href="http://atcoder.jp" target="_blank"><span class="lang"><span class="lang-en">back to atcoder.jp</span><span class="lang-ja">AtCoderへ戻る</span></span></a></li>
        </ul>
                            <ul  id="nav-right-logined" class="nav pull-right" style="display:none;">
            <li class="dropdown">
              <a href="#" lang="ja" class="dropdown-toggle static-nav-language-selector-dropdown" data-toggle="dropdown" style="display:none;">
                <i class="flag-ja"></i> 日本語 <b class="caret"></b>
              </a>
              <a href="#" lang="en" class="dropdown-toggle static-nav-language-selector-dropdown"  data-toggle="dropdown" style="display:none;">
                <i class="flag-en"></i> English <b class="caret"></b>
              </a>
              <a href="#" lang="ko" class="dropdown-toggle static-nav-language-selector-dropdown"  data-toggle="dropdown" style="display:none;">
                <i class="flag-ko"></i> 한국어 <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                <li> <a lang="ja" class="static-nav-language-selector" href="#"><i class="flag-ja"></i> 日本語</a></li>
                <li> <a lang="en" class="static-nav-language-selector" href="#"><i class="flag-en"></i> English</a></li>
                <li> <a lang="ko" class="static-nav-language-selector" href="#"><i class="flag-ko"></i> 한국어</a></li>
              </ul>
            </li>
            <li class="divider-vertical"></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-cog icon-white"></i> <span id="nav-right-username"></span><b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="/me"><span class="lang"><span class="lang-en">My Profile</span><span class="lang-ja">マイプロフィール</span></span></a></li>
                                	<li><a href="/settings"><span class="lang"><span class="lang-en">Settings</span><span class="lang-ja">設定</span></span></a></li>
                    <li><a href="/settings/password"><span class="lang"><span class="lang-en">Change password</span><span class="lang-ja">パスワードの変更</span></span></a></li>
                	                	<li class="divider"></li>
                                <li><a href="/logout"><span class="lang"><span class="lang-en">Sign out</span><span class="lang-ja">ログアウト</span></span></a></li>
             </ul>
            </li>
          </ul>
          <ul id="nav-right-not-login" class="nav pull-right" style="display:none;">
            <li class="dropdown">
              <a href="#" lang="ja" class="dropdown-toggle static-nav-language-selector-dropdown" data-toggle="dropdown" style="display:none;">
                <i class="flag-ja"></i> 日本語 <b class="caret"></b>
              </a>
              <a href="#" lang="en" class="dropdown-toggle static-nav-language-selector-dropdown"  data-toggle="dropdown" style="display:none;">
                <i class="flag-en"></i> English <b class="caret"></b>
              </a>
              <a href="#" lang="ko" class="dropdown-toggle static-nav-language-selector-dropdown"  data-toggle="dropdown" style="display:none;">
                <i class="flag-ko"></i> 한국어 <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                <li> <a lang="ja" class="static-nav-language-selector" href="#"><i class="flag-ja"></i> 日本語</a></li>
                <li> <a lang="en" class="static-nav-language-selector" href="#"><i class="flag-en"></i> English</a></li>
                <li> <a lang="ko" class="static-nav-language-selector" href="#"><i class="flag-ko"></i> 한국어</a></li>
              </ul>
            </li>
                        <li class="divider-vertical"></li>
            <li><a href="/register"><span class="lang"><span class="lang-en">Sign up</span><span class="lang-ja">新規登録</span></span></a></li>
                        <li class="divider-vertical"></li>
            <li><a href="/login"><span class="lang"><span class="lang-en">Sign in</span><span class="lang-ja">ログイン</span></span></a></li>
          </ul>
      </div>
    </div>
  </div>
</div>
        
    <div id="outer-inner" class="container">
      <h1 class="site-title">
          AtCoder Beginner Contest 074
      </h1>
                      <time style="display:none" id="contest-start-time">2017/09/16 12:00:00 +0000</time>
        <time style="display:none" id="contest-end-time">2017/09/16 13:40:00 +0000</time>
        <time style="display:none" id="server-current-time">2017/10/08 20:53:37 +0000</time>

            
      <ul class="nav nav-tabs">
                            <li><a href="http://abc074.contest.atcoder.jp/"><i class="icon-home"></i> <span class="lang"><span class="lang-en">Home</span><span class="lang-ja">トップページ</span><span class="lang-ko">톱 페이지</span></span></a></li>
                                          <li class="active"><a href="http://abc074.contest.atcoder.jp/assignments"><i class="icon-list-alt"></i> <span class="lang"><span class="lang-en">Tasks</span><span class="lang-ja">問題</span><span class="lang-ko">문제</span></span></a></li>
                                          <li><a href="https://abc074.contest.atcoder.jp/submit"><i class="icon-upload"></i> <span class="lang"><span class="lang-en">Submit</span><span class="lang-ja">提出</span><span class="lang-ko">제출</span></span></a></li>
                                          <li><a href="http://abc074.contest.atcoder.jp/clarifications"><i class="icon-question-sign"></i> <span class="lang"><span class="lang-en">Clarifications</span><span class="lang-ja">質問</span><span class="lang-ko">질문</span></span></a></li>
                                          <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
              <b class="caret"></b><i class="icon-download-alt"></i> <span class="lang"><span class="lang-en">Results</span><span class="lang-ja">結果</span><span class="lang-ko">채점 결과</span></span>
            </a>
            <ul class="dropdown-menu">
                              <li><a href="http://abc074.contest.atcoder.jp/submissions/all"><span class="lang"><span class="lang-en">All submissions</span><span class="lang-ja">すべての結果</span><span class="lang-ko">모든 결과</span></span></a></li>
                              <li><a href="https://abc074.contest.atcoder.jp/submissions/me"><span class="lang"><span class="lang-en">My submissions</span><span class="lang-ja">自分の結果</span><span class="lang-ko">자신의 결과</span></span></a></li>
                          </ul>
          </li>
                                          <li><a href="/standings"><i class="icon-user"></i> <span class="lang"><span class="lang-en">Standings</span><span class="lang-ja">順位表</span><span class="lang-ko">순위표</span></span></a></li>
                                          <li><a href="/custom_test"><i class="icon-user"></i> <span class="lang"><span class="lang-en">Custom Test</span><span class="lang-ja">コードテスト</span></span></a></li>
                                          <li><a href="/editorial"><i class="icon-user"></i> <span class="lang"><span class="lang-en">Editorial</span><span class="lang-ja">解説</span></span></a></li>
                      </ul>
        <div id="alert_box" class="alert alert-block" style="display:none">
  <a class="close" data-dismiss="alert">×</a>
  <h4 id="alert_box_heading" class="alert-heading" style="display:none"></h4>
  <p id="alert_box_content"></p>
</div>

      <h2>D - Restoring Road Network</h2>
<hr />
<p><span class="lang"><span class="lang-en">Time limit</span><span class="lang-ja">時間制限</span></span> : 2sec / <span class="lang"><span class="lang-en">Memory limit</span><span class="lang-ja">メモリ制限</span></span> : 256MB</p>

<div id="task-statement">
  <span class="lang">
<span class="lang-ja">
<p>配点: <var>500</var> 点</p>

<div class="part">
<section>
<h3>問題文</h3><p>かつて存在した高橋王国には <var>N</var> 個の都市があり、いくつかの都市の組は道路で双方向に結ばれていました。
道路の構造は以下のようであったことがわかっています。</p>
<ul>
<li>都市間の移動は道路を通ってのみ行われ、どの都市からどの都市へも必要なら他の都市を経由することで移動できるようになっていた。</li>
<li>道路の長さは道路によって異なっていたかもしれないが、全て正整数であった。</li>
</ul>
<p>考古学者のすぬけ君は、高橋王国の遺跡で整数からなる <var>N \times N</var> の表 <var>A</var> を発見しました。
すぬけ君は、この表は高橋王国における都市間の道路に沿った最短距離を表した表ではないかと考えました。</p>
<p>すべての <var>u, v</var> について、<var>A</var> の <var>u</var> 行目 <var>v</var> 列目の整数 <var>A_{u, v}</var> が都市 <var>u</var> から都市 <var>v</var> への最短経路の長さとなるような
道路の構造が存在するかどうか判定してください。
さらに、存在する場合、そのような道路の構造のうち、存在する道路の長さの和が最小となるようなものについて、その和を求めてください。</p>
</section>
</div>

<div class="part">
<section>
<h3>制約</h3><ul>
<li><var>1≦N≦300</var></li>
<li><var>i ≠ j</var> のとき、<var>1 ≦ A_{i, j} = A_{j, i} ≦ 10^9</var></li>
<li><var>A_{i, i} = 0</var></li>
</ul>
</section>
</div>

<hr />

<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var>
<var>A_{1, 1}</var> <var>A_{1, 2}</var> <var>...</var> <var>A_{1, N}</var>
<var>A_{2, 1}</var> <var>A_{2, 2}</var> <var>...</var> <var>A_{2, N}</var>
<var>...</var>
<var>A_{N, 1}</var> <var>A_{N, 2}</var> <var>...</var> <var>A_{N, N}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>条件を満たす道路の構造が存在しない場合、<code>-1</code> と出力せよ。
存在する場合、道路の長さの和の最小値を出力せよ。</p>
</section>
</div>
</div>

<hr />

<div class="part">
<section>
<h3>入力例 1</h3><pre>3
0 1 3
1 0 2
3 2 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre>3
</pre>

<p>条件を満たす道路の構造は以下のとおりです。</p>
<ul>
<li>都市 <var>1</var> と都市 <var>2</var> の間は長さ <var>1</var> の道路によって結ばれている。</li>
<li>都市 <var>2</var> と都市 <var>3</var> の間は長さ <var>2</var> の道路によって結ばれている。</li>
<li>都市 <var>3</var> と都市 <var>1</var> の間は道路で結ばれていない。</li>
</ul>
</section>
</div>

<hr />

<div class="part">
<section>
<h3>入力例 2</h3><pre>3
0 1 3
1 0 1
3 1 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 2</h3><pre>-1
</pre>

<p>都市 <var>1</var> から都市 <var>2</var> へ、および都市 <var>2</var> から都市 <var>3</var> へそれぞれ距離 <var>1</var> で移動できることから、
都市 <var>1</var> から都市 <var>3</var> へは都市 <var>2</var> を経由することで距離 <var>2</var> で移動できることがわかります。
一方、都市 <var>1</var> と都市 <var>3</var> の間の最短距離は <var>3</var> でなければなりません。</p>
<p>よって条件を満たす道路の構造は存在しないことがわかります。</p>
</section>
</div>

<hr />

<div class="part">
<section>
<h3>入力例 3</h3><pre>5
0 21 18 11 28
21 0 13 10 26
18 13 0 23 13
11 10 23 0 17
28 26 13 17 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 3</h3><pre>82
</pre>

</section>
</div>

<hr />

<div class="part">
<section>
<h3>入力例 4</h3><pre>3
0 1000000000 1000000000
1000000000 0 1000000000
1000000000 1000000000 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>出力例 4</h3><pre>3000000000
</pre></section>
</div>
</span>
<span class="lang-en">
<p>Score : <var>500</var> points</p>

<div class="part">
<section>
<h3>Problem Statement</h3><p>In Takahashi Kingdom, which once existed, there are <var>N</var> cities, and some pairs of cities are connected bidirectionally by roads.
The following are known about the road network:</p>
<ul>
<li>People traveled between cities only through roads. It was possible to reach any city from any other city, via intermediate cities if necessary.</li>
<li>Different roads may have had different lengths, but all the lengths were positive integers.</li>
</ul>
<p>Snuke the archeologist found a table with <var>N</var> rows and <var>N</var> columns, <var>A</var>, in the ruin of Takahashi Kingdom.
He thought that it represented the shortest distances between the cities along the roads in the kingdom.</p>
<p>Determine whether there exists a road network such that for each <var>u</var> and <var>v</var>, the integer <var>A_{u, v}</var> at the <var>u</var>-th row and <var>v</var>-th column of <var>A</var> is equal to the length of the shortest path from City <var>u</var> to City <var>v</var>.
If such a network exist, find the shortest possible total length of the roads.</p>
</section>
</div>

<div class="part">
<section>
<h3>Constraints</h3><ul>
<li><var>1 \leq N \leq 300</var></li>
<li>If <var>i ≠ j</var>, <var>1 \leq A_{i, j} = A_{j, i} \leq 10^9</var>.</li>
<li><var>A_{i, i} = 0</var></li>
</ul>
</section>
</div>

<hr />

<div class="io-style">
<div class="part">
<section>
<h3>Inputs</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var>
<var>A_{1, 1}</var> <var>A_{1, 2}</var> <var>...</var> <var>A_{1, N}</var>
<var>A_{2, 1}</var> <var>A_{2, 2}</var> <var>...</var> <var>A_{2, N}</var>
<var>...</var>
<var>A_{N, 1}</var> <var>A_{N, 2}</var> <var>...</var> <var>A_{N, N}</var>
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Outputs</h3><p>If there exists no network that satisfies the condition, print <code>-1</code>.
If it exists, print the shortest possible total length of the roads.</p>
</section>
</div>
</div>

<hr />

<div class="part">
<section>
<h3>Sample Input 1</h3><pre>3
0 1 3
1 0 2
3 2 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre>3
</pre>

<p>The network below satisfies the condition:</p>
<ul>
<li>City <var>1</var> and City <var>2</var> is connected by a road of length <var>1</var>.</li>
<li>City <var>2</var> and City <var>3</var> is connected by a road of length <var>2</var>.</li>
<li>City <var>3</var> and City <var>1</var> is not connected by a road.</li>
</ul>
</section>
</div>

<hr />

<div class="part">
<section>
<h3>Sample Input 2</h3><pre>3
0 1 3
1 0 1
3 1 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 2</h3><pre>-1
</pre>

<p>As there is a path of length <var>1</var> from City <var>1</var> to City <var>2</var> and City <var>2</var> to City <var>3</var>, there is a path of length <var>2</var> from City <var>1</var> to City <var>3</var>.
However, according to the table, the shortest distance between City <var>1</var> and City <var>3</var> must be <var>3</var>.</p>
<p>Thus, we conclude that there exists no network that satisfies the condition.</p>
</section>
</div>

<hr />

<div class="part">
<section>
<h3>Sample Input 3</h3><pre>5
0 21 18 11 28
21 0 13 10 26
18 13 0 23 13
11 10 23 0 17
28 26 13 17 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 3</h3><pre>82
</pre>

</section>
</div>

<hr />

<div class="part">
<section>
<h3>Sample Input 4</h3><pre>3
0 1000000000 1000000000
1000000000 0 1000000000
1000000000 1000000000 0
</pre>

</section>
</div>

<div class="part">
<section>
<h3>Sample Output 4</h3><pre>3000000000
</pre></section>
</div>
</span>
</span>

</div>


<hr/>
<p><a class="btn btn-primary btn-large" href="/submit?task_id=3535"><span class="lang"><span class="lang-en">Submit</span><span class="lang-ja">提出する</span></span></a></p>

<script>$(function(){document.queryCommandSupported("copy")&&($("h3+pre").before('<div class="div-sample-copy"><span class="btn-sample-copy" tabindex="0" data-toggle="tooltip" data-trigger="manual" title="Copied!">Copy</span></div>'),$(".btn-sample-copy").click(function(){window.getSelection().removeAllRanges();try{var e=document.createRange();e.selectNode($(this).parent().next("pre").get()[0]),window.getSelection().addRange(e),document.execCommand("copy"),$(this).tooltip("show");var t=this;setTimeout(function(){$(t).tooltip("hide")},800)}catch(o){console.log(o)}window.getSelection().removeAllRanges()}))});</script>

    </div>

    <footer>
      <ul>
  <li><a href="/tos"><span class="lang"><span class="lang-en">Terms of service</span><span class="lang-ja">利用規約</span></span></a></li>
  <li><a href="/privacy"><span class="lang"><span class="lang-en">Privacy</span><span class="lang-ja">プライバシーポリシー</span></span></a></li>
  <li><a href="/personal"><span class="lang"><span class="lang-en">Personal Information</span><span class="lang-ja">個人情報保護方針</span></span></a></li>
  <li><a href="/tutorial"><span class="lang"><span class="lang-en">Tutorial</span><span class="lang-ja">チュートリアル</span></span></a></li>
  <li><a href="/rules"><span class="lang"><span class="lang-en">Rules</span><span class="lang-ja">ルール</span></span></a></li>
  <li><a href="/glossary"><span class="lang"><span class="lang-en">Glossary</span><span class="lang-ja">用語集</span></span></a></li>
  <li><a href="/faq"><span class="lang"><span class="lang-en">FAQ</span><span class="lang-ja">よくある質問</span></span></a></li>
</ul>
<p id="copyright">&copy; 2017 AtCoder Inc. All rights reserved.</p>
    </footer>

    <p id="fixed-server-timer" style="display: none;"></p>

        <script src="/js/bootstrap.min.js"></script>
    <script src="/js/prettify.js"></script>
    <script src="/js/lang-vb.js"></script>
    <script src="/js/lang-hs.js"></script>
    <script src="/js/varmath.js"></script>
    <script src="/js/script.js?v=2"></script>
  </body>
</html>
