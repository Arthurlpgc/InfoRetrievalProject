
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">












<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<link href="favicon.ico" rel="shortcut icon" type="image/x-icon" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />





<title>9. Super Ants - A2 Online Judge</title>

<meta name="description" content="A2 Online Judge (or Virtual Online Contests) is an online judge with hundreds of problems and it helps you to create, run and participate in virtual contests using problems from the following online judges: A2 Online Judge, Live Archive, Codeforces, Timus, SPOJ, TJU, SGU, PKU, ZOJ, URI. It also helps you to manage and track your programming comepetions training for you and your friends. It helps for ICPC ACM and IOI training also.">
<meta name="keywords" content="ahmed aly,ahmed aly tools,voc,virtual online contests,programming,c++,java,contest,contests,competition,competitions,programming contest,programming contests,programming compitition,programming compititions,cf,codeforces,live archive,uva,spoj,tju,sgu,pku,timus,zoj,uri,programming tools,a2oj,a2 online judge">
<meta name="author" content="Ahmed Aly">
<link href="default.css" rel="stylesheet" type="text/css" />
<link href='DroidSansMono.css' rel='stylesheet' type='text/css'>

		<link rel="stylesheet" href="css/nav.css" />
		<!--[if IE]>
			<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->

<!-- START TRACKING CODE -->
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push( [ '_setAccount', 'UA-16947566-3' ]);
	_gaq.push( [ '_trackPageview' ]);

	( function() {
		var ga = document.createElement('script');
		ga.type = 'text/javascript';
		ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl'
				: 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(ga, s);
	})();
</script>
<!-- END TRACKING CODE -->


<script src="jquery-latest.js"></script>



</head>
<body class="no-js">

<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=123446397673080";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

    	<script>
			var el = document.getElementsByTagName("body")[0];
			el.className = "";
		</script>
        <noscript>
        	<!--[if IE]>
            	<link rel="stylesheet" href="css/ie.css">
            <![endif]-->
        </noscript>
        

<center>
<table width="100%">
<tr>
<td>
        


<div id="wrapper"><!-- start header -->

<div id="logo">
<table width="100%">
<tr>
<td style="vertical-align: bottom;"><a href="/"><img src="logo.png"></a></td>
<td>
<h1 style="padding-top: 11px;">A<sup>2</sup> Online Judge</h1>
<h2 class="author">&raquo;&nbsp;&nbsp;&nbsp;&nbsp; by <a href="https://www.facebook.com/ahmed.aly.tc" target="_blank" style="text-decoration: none;">Ahmed Aly</a></h2>
<br/>
<h3>Sponsored by <b><a href="https://www.facebook.com/elcoachacademy/" target="_blank" style="text-decoration: none;">Coach Academy</a></b> & <b><a href="https://www.facebook.com/acmacpc/" target="_blank" style="text-decoration: none;">ACPC</a></b>, <a href="https://www.codechef.com/" target="_blank" style="text-decoration: none;">CodeChef</a> and <a href="http://www.codability.net/" target="_blank" style="text-decoration: none;">Codability</a></h3>
</td>
<td style="text-align: right; padding-top: 27px;">
<iframe src="https://www.facebook.com/plugins/like.php?show_faces=false&href=https://www.facebook.com/A2OnlineJudge"
	scrolling="no" frameborder="0"
	style="border:none; height:45px"></iframe>
</td>
</tr>
</table>
</div>

<div id="header3"><div align="right"><a href="signin?url=%2Fp%3FID%3D9" style="font-size: 15px;">Sign In</a> - <a href="signup" style="font-size: 15px;">Sign Up</a></div></div>


<div id="header2">
<div id="menu2">

        <nav id="topNav">
          <ul>
<li><a href="/">Contests</a></li><li><a href="ladders"><font color="red">Ladders</font></a></li><li><a href="ps">Problems</a></li><li><a href="status">Status</a></li><li><a href="categories">Categories</a></li><li><a href="groups">Groups</a></li><li><a href="javascript:void();">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;More&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a><ul><li><center><a href="http://goo.gl/Fq5mru" target="_blank">GCJ Tools</a></center></li><li><center><a href="codes">Source Codes</a></center></li><li><center><a href="finder">Problems Finder</a></center></li><li><center><a href="users">Users</a></center></li><li><center><a href="teams">Teams</a></center></li><li><center><a href="cumulative">Cumulative Rank</a></center></li></ul></li><li class="last"><a href="about">About</a></li>
          </ul>
        </nav>
        
        
        <script src="js/modernizr.js"></script>
		<script>
			(function($){
				
				//cache nav
				var nav = $("#topNav");
				
				//add indicator and hovers to submenu parents
				nav.find("li").each(function() {
					if ($(this).find("ul").length > 0) {
						$("<span>").text("^").appendTo($(this).children(":first"));

						//show subnav on hover
						$(this).mouseenter(function() {
							$(this).find("ul").stop(true, true).slideDown();
						});
						
						//hide submenus on exit
						$(this).mouseleave(function() {
							$(this).find("ul").stop(true, true).slideUp();
						});
					}
				});
			})(jQuery);
		</script>


</div>
</div>
<!-- end header --></div>
<!-- start page -->
</td>
</tr>


<tr>

<td style="vertical-align: top;">
<center>
<table>
<tr style="max-height: 0px; padding: 0px;">
<td style="max-height: 0px; padding: 0px; min-width: 165px;"></td>
<td style="max-height: 0px; padding: 0px; min-width: 1060px;"></td>
<td style="max-height: 0px; padding: 0px; min-width: 165px;"></td>
</tr>
<tr>
<td style="padding: 0px; vertical-align: top;">
<div id="leftAd">


</div>
</td>
<td style="padding: 0px; vertical-align: top;">
<div id="page">

<font size="3">
<center>





</center>
</font>

<center>



<div style="font-family: 'Droid Sans Mono', sans-serif; font-size: 20px; font-weight: bold;">
<table>
<tr style="background: #E0E0E0;">
<td style="padding: 10px;"><a href="submit?ID=9">Submit</a></td>

<td style="padding: 10px;"><a href="status?Sort=Time&ID=9">Best Submissions</a></td>
<td style="padding: 10px;"><a href="status?ID=9">All Submissions</a></td>

</tr>
</table>

<br />

9. Super Ants

</div>
</center>
<br/><br/>

<div style="font-family: 'Droid Sans Mono', sans-serif; font-size: 19px; font-weight: bold; text-decoration: underline;">
Problem Statement:
</div>
<div style="font-family: 'Droid Sans Mono', sans-serif; font-size: 17px;">
Here is another game, this game is called the ants game. In this game, you are given a grid, with N rows and M columns. The rows are numbered from 1 to N from top to bottom, and the columns are numbered from 1 to M from left to right. Each cell in the grid has unlimited store of a certain type of sugar, each unit of sugar gives the player a specific score. The game is just 1 step, given 1 super ant, position it in any cell in the grid, and the ant will do its magical work to determine your score.<br/><br/>Once a super ant is placed in one of the cells, it does a systematic behavior to gather sugar units from the stores. If there is no remaining time, the ant gets 1 unit of sugar from the store of its cell and stops working. If there is some remaining time, it starts a magical operation, which is the ants cloning operation.<br/><br/>The super ant starts to clone itself to all the possible cells according to the current remaining time (all of its cloning operations start at the same time). It takes D seconds to clone itself to a cell that is far with D units. An ant at position (R1, C1) is far from the position (R2, C2) by max(|R1 - R2|, |C1 - C2|) units (where |X| means the absolute value of X). Once a new super ant is cloned, it behaves as a super ant by utilizing the remaining time.<br/><br/>At the end, when the remaining time is not enough for any ant to clone itself to any other cell, each ant will collect one unit of sugar from its cell and your score is the sum of the values of all the collected sugar units. Note that an ant can not clone itself to another cell with distance more than the current remaining time, and an ant can not clone itself to the same cell more than once, and it can not clone itself to its cell, and any cell can contain any number of ants at any time.<br/><br/>Okay, which positions an ant can clone itself to them? First of all, an ant can not clone itself to a cell outside of the grid. Second, it can only clone to any cell in one of its 8 directions' vectors. Direction vector means all consecutive cells on the same direction, for example from position (A, B), east vector will generate (A, B + 1), (A, B + 2), (A, B + 3) and so on. In the below image, a super ant with 2 seconds remaining, can clone itself to 16 positions, 8 of them with distance 1 and 8 with distance 2.<br/><br/><center><img src="https://a2oj.com/i3?n=9_A.png"/></center><br/><br/><br/>Given the score value of each sugar unit in the grid, the total allowed time you have (the time starts once the first ant is placed) and a cell which the first super ant will start from it, can you write a program which calculates the score you will get if you used that cell?

</div>



<br/><br/>
<div style="font-family: 'Droid Sans Mono', sans-serif; font-size: 19px; font-weight: bold; text-decoration: underline;">
Input Format:
</div>
<div style="font-family: 'Droid Sans Mono', sans-serif; font-size: 17px;">
Your program will be tested on one or more test cases. The first line of the input will be a single integer T, the number of test cases (1 &#8804; T &#8804; 100). Followed by the test cases, each test case starts with a line containing 3 integers separated by a single space N M S (1 &#8804; N, M &#8804; 50) and (0 &#8804; S &#8804; 500) representing the number of rows in the grid, the number of columns and the remaining time, respectively.<br/><br/>Followed by a line containing 2 integers separated by a single space I J (1 &#8804; I &#8804; N) and (1 &#8804; J &#8804; M) representing the row number and the column number of the cell which the first ant will start from it, respectively. Followed by N lines each line contains M integers separated by a single space, representing the value of each sugar unit in each cell in that row. Each integer in the grid will not be less than 0 and will not be greater than 9.

</div>

<br/><br/>
<div style="font-family: 'Droid Sans Mono', sans-serif; font-size: 19px; font-weight: bold; text-decoration: underline;">
Output Format:
</div>
<div style="font-family: 'Droid Sans Mono', sans-serif; font-size: 17px;">
For each test case, print a single line which contains a single integer representing the score you will get at the end of the game, since the result may be very large, print it modulo 1,000,000,007 (<sub>10</sub>9 + 7).

</div>

<br/><br/>
<div style="font-family: 'Droid Sans Mono', sans-serif;  font-size: 19px; font-weight: bold; text-decoration: underline;">
Sample Input:
</div>
<div style="font-family: 'Droid Sans Mono', sans-serif; font-size: 17px; white-space: pre;">2
5 6 1
3 3
0 2 4 6 8 1
1 1 2 3 1 2
1 4 5 6 3 4
2 7 8 9 5 8
3 5 8 0 7 0
5 6 2
3 3
0 2 4 6 8 1
1 1 2 3 1 2
1 4 5 6 3 4
2 7 8 9 5 8
3 5 8 0 7 0
</div>

<br/><br/>
<div style="font-family: 'Droid Sans Mono', sans-serif;  font-size: 19px; font-weight: bold; text-decoration: underline;">
Sample Output:
</div>
<div style="font-family: 'Droid Sans Mono', sans-serif; font-size: 17px; white-space: pre;">45
349
</div>

<br/><br/>
<div style="font-family: 'Droid Sans Mono', sans-serif; font-size: 19px; font-weight: bold; text-decoration: underline;">
Notes:
</div>
<div style="font-family: 'Droid Sans Mono', sans-serif; font-size: 17px;">
In the first example, the first ant will collect one sugar unit from its cell with score 5. In addition, it will clone 8 ants in the 8 directions, each one of them can only get 1 sugar unit from its cell. The total score is 1 + 2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 = 45.<br/><br/>In the second example, the first ant will clone itself to 8 cells at distance 2, with remaining time 0, and to 8 cells at distance 1 with remaining time 1 (thus each of the latter clones will further clone itself).
</div>


<br/><br/>

<center>
<div style="font-family: 'Droid Sans Mono', sans-serif; font-size: 20px; font-weight: bold;">
<table>
<tr style="background: #E0E0E0;">
<td style="padding: 10px;"><a href="submit?ID=9">Submit</a></td>

<td style="padding: 10px;"><a href="status?Sort=Time&ID=9">Best Submissions</a></td>
<td style="padding: 10px;"><a href="status?ID=9">All Submissions</a></td>

</tr>
</table>
</div>

<br /><br /><br />

<div class="fb-comments" data-href="https://a2oj.com/p?ID=9" data-width="800"></div>

</center>

<p style="border-bottom: 1px solid #5C5C5C;
  padding-bottom: 6px;
  margin-bottom: 1em;">
</p>

<center>
<div style="font-family: 'Droid Sans Mono', sans-serif; font-size: 15px;">
<table>
<tr>
<td style="padding-right: 15px; width: 126px;">
Added by:
</td>
<td>
<a href="profile?Username=abdelkarim">abdelkarim</a>
</td>
</tr>
<tr>
<td style="padding-right: 15px;">
Added at:
</td>
<td>
2014-02-22 00:27:38 UTC
</td>
</tr>
<tr>
<td style="padding-right: 15px;">
Time Limit:
</td>
<td>
120 seconds

</td>
</tr>
<tr>
<td style="padding-right: 15px;">
Partial score:
</td>
<td>
No
</td>
</tr>

<tr><td style="padding-right: 15px;">Source:</td><td><a href="source?ID=1">ACM Arab Collegiate Programming Contest 2013</a></td></tr>

</table>
</div>
</center>

</div>
</td>
<td style="padding: 0px; vertical-align: top;">
<div id="rightAd">


</div>
</td>
</tr>
</table>
</center>
<!-- end page -->
<!-- start footer -->
<div id="footer">
<p id="legal">A2OJ &copy; Copyright 2011-2016 <b><a
	href="https://www.facebook.com/ahmed.aly.tc" target="_blank"
	style="text-decoration: none;">Ahmed Aly</a></b> All Rights Reserved. A2OJ uses <a href="http://sphere-engine.com" target="_blank" style="text-decoration: none;">Sphere Engine</a>&trade; &copy; by <a href="http://sphere-research.com" target="_blank" style="text-decoration: none;">Sphere Research Labs</a>.</p>
</div>
</td>


</tr>
</table>
</center>
<!-- end footer -->


</body>
</html>
