{"props": {"Server time": "  Oct", "integers": "  p 2 "}, "title": "Masha and Cactus", "time-limit": 2000, "statement": "D. Masha and Cactus time limit per test 2 seconds memory limit per test 256 megabytes input standard input output standard output Masha is fond of cacti. When she was a little girl, she decided to plant a tree. Now Masha wants to make a nice cactus out of her tree. Recall that  tree  is a connected undirected graph that has no cycles.  Cactus  is a connected undirected graph such that each vertex belongs to at most one cycle. Masha has some additional edges that she can add to a tree. For each edge she knows which vertices it would connect and the  beauty  of this edge. Masha can add some of these edges to the graph if the resulting graph is a cactus.  Beauty  of the resulting cactus is sum of beauties of all added edges.  Help Masha find out what maximum  beauty  of the resulting cactus she can achieve. Input The first line of the input data contains two integers  n  and  m \u00a0\u2014 the number of vertices in a tree, and the number of additional edges available ( 3\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ;  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ). Let us describe Masha's tree. It has a root at vertex 1. The second line contains  n \u2009-\u20091  integers:  p 2 ,\u2009 p 3 ,\u2009...,\u2009 p n , here  p i \u00a0\u2014 is the parent of a vertex  i \u00a0\u2014 the first vertex on a path from the vertex  i  to the root of the tree ( 1\u2009\u2264\u2009 p i \u2009<\u2009 i ). The following  m  lines contain three integers  u i ,  v i  and  c i \u00a0\u2014 pairs of vertices to be connected by the additional edges that Masha can add to the tree and  beauty  of edge ( 1\u2009\u2264\u2009 u i ,\u2009 v i \u2009\u2264\u2009 n ;  u i \u2009\u2260\u2009 v i ;  1\u2009\u2264\u2009 c i \u2009\u2264\u200910 4 ). It is guaranteed that no additional edge coincides with the edge of the tree. Output Output one integer\u00a0\u2014 the maximum  beauty  of a cactus Masha can achieve. Example Input 7 3 1 1 2 2 3 3 4 5 1 6 7 1 2 3 1 Output 2 D. Masha and Cactus time limit per test 2 seconds memory limit per test 256 megabytes input standard input output standard output Masha is fond of cacti. When she was a little girl, she decided to plant a tree. Now Masha wants to make a nice cactus out of her tree. Recall that  tree  is a connected undirected graph that has no cycles.  Cactus  is a connected undirected graph such that each vertex belongs to at most one cycle. Masha has some additional edges that she can add to a tree. For each edge she knows which vertices it would connect and the  beauty  of this edge. Masha can add some of these edges to the graph if the resulting graph is a cactus.  Beauty  of the resulting cactus is sum of beauties of all added edges.  Help Masha find out what maximum  beauty  of the resulting cactus she can achieve. Input The first line of the input data contains two integers  n  and  m \u00a0\u2014 the number of vertices in a tree, and the number of additional edges available ( 3\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ;  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ). Let us describe Masha's tree. It has a root at vertex 1. The second line contains  n \u2009-\u20091  integers:  p 2 ,\u2009 p 3 ,\u2009...,\u2009 p n , here  p i \u00a0\u2014 is the parent of a vertex  i \u00a0\u2014 the first vertex on a path from the vertex  i  to the root of the tree ( 1\u2009\u2264\u2009 p i \u2009<\u2009 i ). The following  m  lines contain three integers  u i ,  v i  and  c i \u00a0\u2014 pairs of vertices to be connected by the additional edges that Masha can add to the tree and  beauty  of edge ( 1\u2009\u2264\u2009 u i ,\u2009 v i \u2009\u2264\u2009 n ;  u i \u2009\u2260\u2009 v i ;  1\u2009\u2264\u2009 c i \u2009\u2264\u200910 4 ). It is guaranteed that no additional edge coincides with the edge of the tree. Output Output one integer\u00a0\u2014 the maximum  beauty  of a cactus Masha can achieve. Example Input 7 3 1 1 2 2 3 3 4 5 1 6 7 1 2 3 1 Output 2 D. Masha and Cactus time limit per test 2 seconds memory limit per test 256 megabytes input standard input output standard output Masha is fond of cacti. When she was a little girl, she decided to plant a tree. Now Masha wants to make a nice cactus out of her tree. Recall that  tree  is a connected undirected graph that has no cycles.  Cactus  is a connected undirected graph such that each vertex belongs to at most one cycle. Masha has some additional edges that she can add to a tree. For each edge she knows which vertices it would connect and the  beauty  of this edge. Masha can add some of these edges to the graph if the resulting graph is a cactus.  Beauty  of the resulting cactus is sum of beauties of all added edges.  Help Masha find out what maximum  beauty  of the resulting cactus she can achieve. Input The first line of the input data contains two integers  n  and  m \u00a0\u2014 the number of vertices in a tree, and the number of additional edges available ( 3\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ;  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ). Let us describe Masha's tree. It has a root at vertex 1. The second line contains  n \u2009-\u20091  integers:  p 2 ,\u2009 p 3 ,\u2009...,\u2009 p n , here  p i \u00a0\u2014 is the parent of a vertex  i \u00a0\u2014 the first vertex on a path from the vertex  i  to the root of the tree ( 1\u2009\u2264\u2009 p i \u2009<\u2009 i ). The following  m  lines contain three integers  u i ,  v i  and  c i \u00a0\u2014 pairs of vertices to be connected by the additional edges that Masha can add to the tree and  beauty  of edge ( 1\u2009\u2264\u2009 u i ,\u2009 v i \u2009\u2264\u2009 n ;  u i \u2009\u2260\u2009 v i ;  1\u2009\u2264\u2009 c i \u2009\u2264\u200910 4 ). It is guaranteed that no additional edge coincides with the edge of the tree. Output Output one integer\u00a0\u2014 the maximum  beauty  of a cactus Masha can achieve. Example Input 7 3 1 1 2 2 3 3 4 5 1 6 7 1 2 3 1 Output 2 D. Masha and Cactus time limit per test 2 seconds memory limit per test 256 megabytes input standard input output standard output Masha is fond of cacti. When she was a little girl, she decided to plant a tree. Now Masha wants to make a nice cactus out of her tree. Recall that  tree  is a connected undirected graph that has no cycles.  Cactus  is a connected undirected graph such that each vertex belongs to at most one cycle. Masha has some additional edges that she can add to a tree. For each edge she knows which vertices it would connect and the  beauty  of this edge. Masha can add some of these edges to the graph if the resulting graph is a cactus.  Beauty  of the resulting cactus is sum of beauties of all added edges.  Help Masha find out what maximum  beauty  of the resulting cactus she can achieve. Input The first line of the input data contains two integers  n  and  m \u00a0\u2014 the number of vertices in a tree, and the number of additional edges available ( 3\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ;  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ). Let us describe Masha's tree. It has a root at vertex 1. The second line contains  n \u2009-\u20091  integers:  p 2 ,\u2009 p 3 ,\u2009...,\u2009 p n , here  p i \u00a0\u2014 is the parent of a vertex  i \u00a0\u2014 the first vertex on a path from the vertex  i  to the root of the tree ( 1\u2009\u2264\u2009 p i \u2009<\u2009 i ). The following  m  lines contain three integers  u i ,  v i  and  c i \u00a0\u2014 pairs of vertices to be connected by the additional edges that Masha can add to the tree and  beauty  of edge ( 1\u2009\u2264\u2009 u i ,\u2009 v i \u2009\u2264\u2009 n ;  u i \u2009\u2260\u2009 v i ;  1\u2009\u2264\u2009 c i \u2009\u2264\u200910 4 ). It is guaranteed that no additional edge coincides with the edge of the tree. Output Output one integer\u00a0\u2014 the maximum  beauty  of a cactus Masha can achieve. Example Input 7 3 1 1 2 2 3 3 4 5 1 6 7 1 2 3 1 Output 2 D. Masha and Cactus time limit per test 2 seconds memory limit per test 256 megabytes input standard input output standard output Masha is fond of cacti. When she was a little girl, she decided to plant a tree. Now Masha wants to make a nice cactus out of her tree. Recall that  tree  is a connected undirected graph that has no cycles.  Cactus  is a connected undirected graph such that each vertex belongs to at most one cycle. Masha has some additional edges that she can add to a tree. For each edge she knows which vertices it would connect and the  beauty  of this edge. Masha can add some of these edges to the graph if the resulting graph is a cactus.  Beauty  of the resulting cactus is sum of beauties of all added edges.  Help Masha find out what maximum  beauty  of the resulting cactus she can achieve. Input The first line of the input data contains two integers  n  and  m \u00a0\u2014 the number of vertices in a tree, and the number of additional edges available ( 3\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ;  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ). Let us describe Masha's tree. It has a root at vertex 1. The second line contains  n \u2009-\u20091  integers:  p 2 ,\u2009 p 3 ,\u2009...,\u2009 p n , here  p i \u00a0\u2014 is the parent of a vertex  i \u00a0\u2014 the first vertex on a path from the vertex  i  to the root of the tree ( 1\u2009\u2264\u2009 p i \u2009<\u2009 i ). The following  m  lines contain three integers  u i ,  v i  and  c i \u00a0\u2014 pairs of vertices to be connected by the additional edges that Masha can add to the tree and  beauty  of edge ( 1\u2009\u2264\u2009 u i ,\u2009 v i \u2009\u2264\u2009 n ;  u i \u2009\u2260\u2009 v i ;  1\u2009\u2264\u2009 c i \u2009\u2264\u200910 4 ). It is guaranteed that no additional edge coincides with the edge of the tree. Output Output one integer\u00a0\u2014 the maximum  beauty  of a cactus Masha can achieve. Example Input 7 3 1 1 2 2 3 3 4 5 1 6 7 1 2 3 1 Output 2 D. Masha and Cactus time limit per test 2 seconds memory limit per test 256 megabytes input standard input output standard output Masha is fond of cacti. When she was a little girl, she decided to plant a tree. Now Masha wants to make a nice cactus out of her tree. Recall that  tree  is a connected undirected graph that has no cycles.  Cactus  is a connected undirected graph such that each vertex belongs to at most one cycle. Masha has some additional edges that she can add to a tree. For each edge she knows which vertices it would connect and the  beauty  of this edge. Masha can add some of these edges to the graph if the resulting graph is a cactus.  Beauty  of the resulting cactus is sum of beauties of all added edges.  Help Masha find out what maximum  beauty  of the resulting cactus she can achieve. Input The first line of the input data contains two integers  n  and  m \u00a0\u2014 the number of vertices in a tree, and the number of additional edges available ( 3\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ;  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ). Let us describe Masha's tree. It has a root at vertex 1. The second line contains  n \u2009-\u20091  integers:  p 2 ,\u2009 p 3 ,\u2009...,\u2009 p n , here  p i \u00a0\u2014 is the parent of a vertex  i \u00a0\u2014 the first vertex on a path from the vertex  i  to the root of the tree ( 1\u2009\u2264\u2009 p i \u2009<\u2009 i ). The following  m  lines contain three integers  u i ,  v i  and  c i \u00a0\u2014 pairs of vertices to be connected by the additional edges that Masha can add to the tree and  beauty  of edge ( 1\u2009\u2264\u2009 u i ,\u2009 v i \u2009\u2264\u2009 n ;  u i \u2009\u2260\u2009 v i ;  1\u2009\u2264\u2009 c i \u2009\u2264\u200910 4 ). It is guaranteed that no additional edge coincides with the edge of the tree. Output Output one integer\u00a0\u2014 the maximum  beauty  of a cactus Masha can achieve. Example Input 7 3 1 1 2 2 3 3 4 5 1 6 7 1 2 3 1 Output 2 D. Masha and Cactus time limit per test 2 seconds memory limit per test 256 megabytes input standard input output standard output Masha is fond of cacti. When she was a little girl, she decided to plant a tree. Now Masha wants to make a nice cactus out of her tree. Recall that  tree  is a connected undirected graph that has no cycles.  Cactus  is a connected undirected graph such that each vertex belongs to at most one cycle. Masha has some additional edges that she can add to a tree. For each edge she knows which vertices it would connect and the  beauty  of this edge. Masha can add some of these edges to the graph if the resulting graph is a cactus.  Beauty  of the resulting cactus is sum of beauties of all added edges.  Help Masha find out what maximum  beauty  of the resulting cactus she can achieve. Input The first line of the input data contains two integers  n  and  m \u00a0\u2014 the number of vertices in a tree, and the number of additional edges available ( 3\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ;  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ). Let us describe Masha's tree. It has a root at vertex 1. The second line contains  n \u2009-\u20091  integers:  p 2 ,\u2009 p 3 ,\u2009...,\u2009 p n , here  p i \u00a0\u2014 is the parent of a vertex  i \u00a0\u2014 the first vertex on a path from the vertex  i  to the root of the tree ( 1\u2009\u2264\u2009 p i \u2009<\u2009 i ). The following  m  lines contain three integers  u i ,  v i  and  c i \u00a0\u2014 pairs of vertices to be connected by the additional edges that Masha can add to the tree and  beauty  of edge ( 1\u2009\u2264\u2009 u i ,\u2009 v i \u2009\u2264\u2009 n ;  u i \u2009\u2260\u2009 v i ;  1\u2009\u2264\u2009 c i \u2009\u2264\u200910 4 ). It is guaranteed that no additional edge coincides with the edge of the tree. Output Output one integer\u00a0\u2014 the maximum  beauty  of a cactus Masha can achieve. Example Input 7 3 1 1 2 2 3 3 4 5 1 6 7 1 2 3 1 Output 2 D. Masha and Cactus time limit per test 2 seconds memory limit per test 256 megabytes input standard input output standard output Masha is fond of cacti. When she was a little girl, she decided to plant a tree. Now Masha wants to make a nice cactus out of her tree. Recall that  tree  is a connected undirected graph that has no cycles.  Cactus  is a connected undirected graph such that each vertex belongs to at most one cycle. Masha has some additional edges that she can add to a tree. For each edge she knows which vertices it would connect and the  beauty  of this edge. Masha can add some of these edges to the graph if the resulting graph is a cactus.  Beauty  of the resulting cactus is sum of beauties of all added edges.  Help Masha find out what maximum  beauty  of the resulting cactus she can achieve. Input The first line of the input data contains two integers  n  and  m \u00a0\u2014 the number of vertices in a tree, and the number of additional edges available ( 3\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ;  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ). Let us describe Masha's tree. It has a root at vertex 1. The second line contains  n \u2009-\u20091  integers:  p 2 ,\u2009 p 3 ,\u2009...,\u2009 p n , here  p i \u00a0\u2014 is the parent of a vertex  i \u00a0\u2014 the first vertex on a path from the vertex  i  to the root of the tree ( 1\u2009\u2264\u2009 p i \u2009<\u2009 i ). The following  m  lines contain three integers  u i ,  v i  and  c i \u00a0\u2014 pairs of vertices to be connected by the additional edges that Masha can add to the tree and  beauty  of edge ( 1\u2009\u2264\u2009 u i ,\u2009 v i \u2009\u2264\u2009 n ;  u i \u2009\u2260\u2009 v i ;  1\u2009\u2264\u2009 c i \u2009\u2264\u200910 4 ). It is guaranteed that no additional edge coincides with the edge of the tree. Output Output one integer\u00a0\u2014 the maximum  beauty  of a cactus Masha can achieve. Example Input 7 3 1 1 2 2 3 3 4 5 1 6 7 1 2 3 1 Output 2 D. Masha and Cactus time limit per test 2 seconds memory limit per test 256 megabytes input standard input output standard output Masha is fond of cacti. When she was a little girl, she decided to plant a tree. Now Masha wants to make a nice cactus out of her tree. Recall that  tree  is a connected undirected graph that has no cycles.  Cactus  is a connected undirected graph such that each vertex belongs to at most one cycle. Masha has some additional edges that she can add to a tree. For each edge she knows which vertices it would connect and the  beauty  of this edge. Masha can add some of these edges to the graph if the resulting graph is a cactus.  Beauty  of the resulting cactus is sum of beauties of all added edges.  Help Masha find out what maximum  beauty  of the resulting cactus she can achieve. Input The first line of the input data contains two integers  n  and  m \u00a0\u2014 the number of vertices in a tree, and the number of additional edges available ( 3\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ;  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ). Let us describe Masha's tree. It has a root at vertex 1. The second line contains  n \u2009-\u20091  integers:  p 2 ,\u2009 p 3 ,\u2009...,\u2009 p n , here  p i \u00a0\u2014 is the parent of a vertex  i \u00a0\u2014 the first vertex on a path from the vertex  i  to the root of the tree ( 1\u2009\u2264\u2009 p i \u2009<\u2009 i ). The following  m  lines contain three integers  u i ,  v i  and  c i \u00a0\u2014 pairs of vertices to be connected by the additional edges that Masha can add to the tree and  beauty  of edge ( 1\u2009\u2264\u2009 u i ,\u2009 v i \u2009\u2264\u2009 n ;  u i \u2009\u2260\u2009 v i ;  1\u2009\u2264\u2009 c i \u2009\u2264\u200910 4 ). It is guaranteed that no additional edge coincides with the edge of the tree. Output Output one integer\u00a0\u2014 the maximum  beauty  of a cactus Masha can achieve. Example Input 7 3 1 1 2 2 3 3 4 5 1 6 7 1 2 3 1 Output 2 D. Masha and Cactus time limit per test 2 seconds memory limit per test 256 megabytes input standard input output standard output Masha is fond of cacti. When she was a little girl, she decided to plant a tree. Now Masha wants to make a nice cactus out of her tree. Recall that  tree  is a connected undirected graph that has no cycles.  Cactus  is a connected undirected graph such that each vertex belongs to at most one cycle. Masha has some additional edges that she can add to a tree. For each edge she knows which vertices it would connect and the  beauty  of this edge. Masha can add some of these edges to the graph if the resulting graph is a cactus.  Beauty  of the resulting cactus is sum of beauties of all added edges.  Help Masha find out what maximum  beauty  of the resulting cactus she can achieve. Input The first line of the input data contains two integers  n  and  m \u00a0\u2014 the number of vertices in a tree, and the number of additional edges available ( 3\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ;  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ). Let us describe Masha's tree. It has a root at vertex 1. The second line contains  n \u2009-\u20091  integers:  p 2 ,\u2009 p 3 ,\u2009...,\u2009 p n , here  p i \u00a0\u2014 is the parent of a vertex  i \u00a0\u2014 the first vertex on a path from the vertex  i  to the root of the tree ( 1\u2009\u2264\u2009 p i \u2009<\u2009 i ). The following  m  lines contain three integers  u i ,  v i  and  c i \u00a0\u2014 pairs of vertices to be connected by the additional edges that Masha can add to the tree and  beauty  of edge ( 1\u2009\u2264\u2009 u i ,\u2009 v i \u2009\u2264\u2009 n ;  u i \u2009\u2260\u2009 v i ;  1\u2009\u2264\u2009 c i \u2009\u2264\u200910 4 ). It is guaranteed that no additional edge coincides with the edge of the tree. Output Output one integer\u00a0\u2014 the maximum  beauty  of a cactus Masha can achieve. Example Input 7 3 1 1 2 2 3 3 4 5 1 6 7 1 2 3 1 Output 2", "memory-limit": 256}