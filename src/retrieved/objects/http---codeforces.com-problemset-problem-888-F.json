{"title": "Connecting Vertices", "time-limit": 4000, "memory-limit": 256, "props": {"Server time": "  Dec"}, "statement": "F. Connecting Vertices time limit per test 4 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  points marked on the plane. The points are situated in such a way that they form a regular polygon (marked points are its vertices, and they are numbered in counter-clockwise order). You can draw  n \u2009-\u20091  segments, each connecting any two marked points, in such a way that all points have to be connected with each other (directly or indirectly). But there are some restrictions. Firstly, some pairs of points cannot be connected directly and have to be connected undirectly. Secondly, the segments you draw must not intersect in any point apart from the marked points (that is, if any two segments intersect and their intersection is not a marked point, then the picture you have drawn is invalid). How many ways are there to connect all vertices with  n \u2009-\u20091  segments? Two ways are considered different iff there exist some pair of points such that a segment is drawn between them in the first way of connection, but it is not drawn between these points in the second one. Since the answer might be large, output it modulo  10 9 \u2009+\u20097 . Input The first line contains one number  n  ( 3\u2009\u2264\u2009 n \u2009\u2264\u2009500 ) \u2014 the number of marked points. Then  n  lines follow, each containing  n  elements.  a i ,\u2009 j  ( j -th element of line  i ) is equal to  1  iff you can connect points  i  and  j  directly (otherwise  a i ,\u2009 j \u2009=\u20090 ). It is guaranteed that for any pair of points  a i ,\u2009 j \u2009=\u2009 a j ,\u2009 i , and for any point  a i ,\u2009 i \u2009=\u20090 . Output Print the number of ways to connect points modulo  10 9 \u2009+\u20097 . Examples Input 3 0 0 1 0 0 1 1 1 0 Output 1 Input 4 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 Output 12 Input 3 0 0 0 0 0 1 0 1 0 Output 0 F. Connecting Vertices time limit per test 4 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  points marked on the plane. The points are situated in such a way that they form a regular polygon (marked points are its vertices, and they are numbered in counter-clockwise order). You can draw  n \u2009-\u20091  segments, each connecting any two marked points, in such a way that all points have to be connected with each other (directly or indirectly). But there are some restrictions. Firstly, some pairs of points cannot be connected directly and have to be connected undirectly. Secondly, the segments you draw must not intersect in any point apart from the marked points (that is, if any two segments intersect and their intersection is not a marked point, then the picture you have drawn is invalid). How many ways are there to connect all vertices with  n \u2009-\u20091  segments? Two ways are considered different iff there exist some pair of points such that a segment is drawn between them in the first way of connection, but it is not drawn between these points in the second one. Since the answer might be large, output it modulo  10 9 \u2009+\u20097 . Input The first line contains one number  n  ( 3\u2009\u2264\u2009 n \u2009\u2264\u2009500 ) \u2014 the number of marked points. Then  n  lines follow, each containing  n  elements.  a i ,\u2009 j  ( j -th element of line  i ) is equal to  1  iff you can connect points  i  and  j  directly (otherwise  a i ,\u2009 j \u2009=\u20090 ). It is guaranteed that for any pair of points  a i ,\u2009 j \u2009=\u2009 a j ,\u2009 i , and for any point  a i ,\u2009 i \u2009=\u20090 . Output Print the number of ways to connect points modulo  10 9 \u2009+\u20097 . Examples Input 3 0 0 1 0 0 1 1 1 0 Output 1 Input 4 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 Output 12 Input 3 0 0 0 0 0 1 0 1 0 Output 0 F. Connecting Vertices time limit per test 4 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  points marked on the plane. The points are situated in such a way that they form a regular polygon (marked points are its vertices, and they are numbered in counter-clockwise order). You can draw  n \u2009-\u20091  segments, each connecting any two marked points, in such a way that all points have to be connected with each other (directly or indirectly). But there are some restrictions. Firstly, some pairs of points cannot be connected directly and have to be connected undirectly. Secondly, the segments you draw must not intersect in any point apart from the marked points (that is, if any two segments intersect and their intersection is not a marked point, then the picture you have drawn is invalid). How many ways are there to connect all vertices with  n \u2009-\u20091  segments? Two ways are considered different iff there exist some pair of points such that a segment is drawn between them in the first way of connection, but it is not drawn between these points in the second one. Since the answer might be large, output it modulo  10 9 \u2009+\u20097 . Input The first line contains one number  n  ( 3\u2009\u2264\u2009 n \u2009\u2264\u2009500 ) \u2014 the number of marked points. Then  n  lines follow, each containing  n  elements.  a i ,\u2009 j  ( j -th element of line  i ) is equal to  1  iff you can connect points  i  and  j  directly (otherwise  a i ,\u2009 j \u2009=\u20090 ). It is guaranteed that for any pair of points  a i ,\u2009 j \u2009=\u2009 a j ,\u2009 i , and for any point  a i ,\u2009 i \u2009=\u20090 . Output Print the number of ways to connect points modulo  10 9 \u2009+\u20097 . Examples Input 3 0 0 1 0 0 1 1 1 0 Output 1 Input 4 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 Output 12 Input 3 0 0 0 0 0 1 0 1 0 Output 0 F. Connecting Vertices time limit per test 4 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  points marked on the plane. The points are situated in such a way that they form a regular polygon (marked points are its vertices, and they are numbered in counter-clockwise order). You can draw  n \u2009-\u20091  segments, each connecting any two marked points, in such a way that all points have to be connected with each other (directly or indirectly). But there are some restrictions. Firstly, some pairs of points cannot be connected directly and have to be connected undirectly. Secondly, the segments you draw must not intersect in any point apart from the marked points (that is, if any two segments intersect and their intersection is not a marked point, then the picture you have drawn is invalid). How many ways are there to connect all vertices with  n \u2009-\u20091  segments? Two ways are considered different iff there exist some pair of points such that a segment is drawn between them in the first way of connection, but it is not drawn between these points in the second one. Since the answer might be large, output it modulo  10 9 \u2009+\u20097 . Input The first line contains one number  n  ( 3\u2009\u2264\u2009 n \u2009\u2264\u2009500 ) \u2014 the number of marked points. Then  n  lines follow, each containing  n  elements.  a i ,\u2009 j  ( j -th element of line  i ) is equal to  1  iff you can connect points  i  and  j  directly (otherwise  a i ,\u2009 j \u2009=\u20090 ). It is guaranteed that for any pair of points  a i ,\u2009 j \u2009=\u2009 a j ,\u2009 i , and for any point  a i ,\u2009 i \u2009=\u20090 . Output Print the number of ways to connect points modulo  10 9 \u2009+\u20097 . Examples Input 3 0 0 1 0 0 1 1 1 0 Output 1 Input 4 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 Output 12 Input 3 0 0 0 0 0 1 0 1 0 Output 0 F. Connecting Vertices time limit per test 4 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  points marked on the plane. The points are situated in such a way that they form a regular polygon (marked points are its vertices, and they are numbered in counter-clockwise order). You can draw  n \u2009-\u20091  segments, each connecting any two marked points, in such a way that all points have to be connected with each other (directly or indirectly). But there are some restrictions. Firstly, some pairs of points cannot be connected directly and have to be connected undirectly. Secondly, the segments you draw must not intersect in any point apart from the marked points (that is, if any two segments intersect and their intersection is not a marked point, then the picture you have drawn is invalid). How many ways are there to connect all vertices with  n \u2009-\u20091  segments? Two ways are considered different iff there exist some pair of points such that a segment is drawn between them in the first way of connection, but it is not drawn between these points in the second one. Since the answer might be large, output it modulo  10 9 \u2009+\u20097 . Input The first line contains one number  n  ( 3\u2009\u2264\u2009 n \u2009\u2264\u2009500 ) \u2014 the number of marked points. Then  n  lines follow, each containing  n  elements.  a i ,\u2009 j  ( j -th element of line  i ) is equal to  1  iff you can connect points  i  and  j  directly (otherwise  a i ,\u2009 j \u2009=\u20090 ). It is guaranteed that for any pair of points  a i ,\u2009 j \u2009=\u2009 a j ,\u2009 i , and for any point  a i ,\u2009 i \u2009=\u20090 . Output Print the number of ways to connect points modulo  10 9 \u2009+\u20097 . Examples Input 3 0 0 1 0 0 1 1 1 0 Output 1 Input 4 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 Output 12 Input 3 0 0 0 0 0 1 0 1 0 Output 0 F. Connecting Vertices time limit per test 4 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  points marked on the plane. The points are situated in such a way that they form a regular polygon (marked points are its vertices, and they are numbered in counter-clockwise order). You can draw  n \u2009-\u20091  segments, each connecting any two marked points, in such a way that all points have to be connected with each other (directly or indirectly). But there are some restrictions. Firstly, some pairs of points cannot be connected directly and have to be connected undirectly. Secondly, the segments you draw must not intersect in any point apart from the marked points (that is, if any two segments intersect and their intersection is not a marked point, then the picture you have drawn is invalid). How many ways are there to connect all vertices with  n \u2009-\u20091  segments? Two ways are considered different iff there exist some pair of points such that a segment is drawn between them in the first way of connection, but it is not drawn between these points in the second one. Since the answer might be large, output it modulo  10 9 \u2009+\u20097 . Input The first line contains one number  n  ( 3\u2009\u2264\u2009 n \u2009\u2264\u2009500 ) \u2014 the number of marked points. Then  n  lines follow, each containing  n  elements.  a i ,\u2009 j  ( j -th element of line  i ) is equal to  1  iff you can connect points  i  and  j  directly (otherwise  a i ,\u2009 j \u2009=\u20090 ). It is guaranteed that for any pair of points  a i ,\u2009 j \u2009=\u2009 a j ,\u2009 i , and for any point  a i ,\u2009 i \u2009=\u20090 . Output Print the number of ways to connect points modulo  10 9 \u2009+\u20097 . Examples Input 3 0 0 1 0 0 1 1 1 0 Output 1 Input 4 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 Output 12 Input 3 0 0 0 0 0 1 0 1 0 Output 0 F. Connecting Vertices time limit per test 4 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  points marked on the plane. The points are situated in such a way that they form a regular polygon (marked points are its vertices, and they are numbered in counter-clockwise order). You can draw  n \u2009-\u20091  segments, each connecting any two marked points, in such a way that all points have to be connected with each other (directly or indirectly). But there are some restrictions. Firstly, some pairs of points cannot be connected directly and have to be connected undirectly. Secondly, the segments you draw must not intersect in any point apart from the marked points (that is, if any two segments intersect and their intersection is not a marked point, then the picture you have drawn is invalid). How many ways are there to connect all vertices with  n \u2009-\u20091  segments? Two ways are considered different iff there exist some pair of points such that a segment is drawn between them in the first way of connection, but it is not drawn between these points in the second one. Since the answer might be large, output it modulo  10 9 \u2009+\u20097 . Input The first line contains one number  n  ( 3\u2009\u2264\u2009 n \u2009\u2264\u2009500 ) \u2014 the number of marked points. Then  n  lines follow, each containing  n  elements.  a i ,\u2009 j  ( j -th element of line  i ) is equal to  1  iff you can connect points  i  and  j  directly (otherwise  a i ,\u2009 j \u2009=\u20090 ). It is guaranteed that for any pair of points  a i ,\u2009 j \u2009=\u2009 a j ,\u2009 i , and for any point  a i ,\u2009 i \u2009=\u20090 . Output Print the number of ways to connect points modulo  10 9 \u2009+\u20097 . Examples Input 3 0 0 1 0 0 1 1 1 0 Output 1 Input 4 0 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 Output 12 Input 3 0 0 0 0 0 1 0 1 0 Output 0"}