{"title": "Berland Army", "time-limit": 3000, "memory-limit": 256, "props": {"so that": "    for each ", "Server time": "  Dec"}, "statement": "B. Berland Army time limit per test 3 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  military men in the Berland army. Some of them have given orders to other military men by now. Given  m  pairs ( x i ,  y i ), meaning that the military man  x i  gave the  i -th order to another military man  y i . It is time for reform! The Berland Ministry of Defence plans to introduce ranks in the Berland army. Each military man should be assigned a rank \u2014 integer number between  1  and  k , inclusive. Some of them have been already assigned a rank, but the rest of them should get a rank soon. Help the ministry to assign ranks to the rest of the army so that:    for each of  m  orders it is true that the rank of a person giving the order (military man  x i ) is strictly greater than the rank of a person receiving the order (military man  y i );   for each rank from  1  to  k  there is at least one military man with this rank.  Input The first line contains three integers  n ,  m  and  k  ( 1\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ,  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ,  1\u2009\u2264\u2009 k \u2009\u2264\u20092\u00b710 5 ) \u2014 number of military men in the Berland army, number of orders and number of ranks. The second line contains  n  integers  r 1 ,\u2009 r 2 ,\u2009...,\u2009 r n , where  r i \u2009>\u20090  (in this case  1\u2009\u2264\u2009 r i \u2009\u2264\u2009 k ) means that the  i -th military man has been already assigned the rank  r i ;  r i \u2009=\u20090  means the  i -th military man doesn't have a rank yet. The following  m  lines contain orders one per line. Each order is described with a line containing two integers  x i ,  y i  ( 1\u2009\u2264\u2009 x i ,\u2009 y i \u2009\u2264\u2009 n ,  x i \u2009\u2260\u2009 y i ). This line means that the  i -th order was given by the military man  x i  to the military man  y i . For each pair  ( x ,\u2009 y )  of military men there could be several orders from  x  to  y . Output Print  n  integers, where the  i -th number is the rank of the  i -th military man. If there are many solutions, print any of them. If there is no solution, print the only number  -1 . Examples Input 5 3 3 0 3 0 0 2 2 4 3 4 3 5 Output 1 3 3 2 2  Input 7 6 5 0 4 5 4 1 0 0 6 1 3 6 3 1 7 5 7 1 7 4 Output 2 4 5 4 1 3 5  Input 2 2 2 2 1 1 2 2 1 Output -1 B. Berland Army time limit per test 3 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  military men in the Berland army. Some of them have given orders to other military men by now. Given  m  pairs ( x i ,  y i ), meaning that the military man  x i  gave the  i -th order to another military man  y i . It is time for reform! The Berland Ministry of Defence plans to introduce ranks in the Berland army. Each military man should be assigned a rank \u2014 integer number between  1  and  k , inclusive. Some of them have been already assigned a rank, but the rest of them should get a rank soon. Help the ministry to assign ranks to the rest of the army so that:    for each of  m  orders it is true that the rank of a person giving the order (military man  x i ) is strictly greater than the rank of a person receiving the order (military man  y i );   for each rank from  1  to  k  there is at least one military man with this rank.  Input The first line contains three integers  n ,  m  and  k  ( 1\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ,  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ,  1\u2009\u2264\u2009 k \u2009\u2264\u20092\u00b710 5 ) \u2014 number of military men in the Berland army, number of orders and number of ranks. The second line contains  n  integers  r 1 ,\u2009 r 2 ,\u2009...,\u2009 r n , where  r i \u2009>\u20090  (in this case  1\u2009\u2264\u2009 r i \u2009\u2264\u2009 k ) means that the  i -th military man has been already assigned the rank  r i ;  r i \u2009=\u20090  means the  i -th military man doesn't have a rank yet. The following  m  lines contain orders one per line. Each order is described with a line containing two integers  x i ,  y i  ( 1\u2009\u2264\u2009 x i ,\u2009 y i \u2009\u2264\u2009 n ,  x i \u2009\u2260\u2009 y i ). This line means that the  i -th order was given by the military man  x i  to the military man  y i . For each pair  ( x ,\u2009 y )  of military men there could be several orders from  x  to  y . Output Print  n  integers, where the  i -th number is the rank of the  i -th military man. If there are many solutions, print any of them. If there is no solution, print the only number  -1 . Examples Input 5 3 3 0 3 0 0 2 2 4 3 4 3 5 Output 1 3 3 2 2  Input 7 6 5 0 4 5 4 1 0 0 6 1 3 6 3 1 7 5 7 1 7 4 Output 2 4 5 4 1 3 5  Input 2 2 2 2 1 1 2 2 1 Output -1 B. Berland Army time limit per test 3 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  military men in the Berland army. Some of them have given orders to other military men by now. Given  m  pairs ( x i ,  y i ), meaning that the military man  x i  gave the  i -th order to another military man  y i . It is time for reform! The Berland Ministry of Defence plans to introduce ranks in the Berland army. Each military man should be assigned a rank \u2014 integer number between  1  and  k , inclusive. Some of them have been already assigned a rank, but the rest of them should get a rank soon. Help the ministry to assign ranks to the rest of the army so that:    for each of  m  orders it is true that the rank of a person giving the order (military man  x i ) is strictly greater than the rank of a person receiving the order (military man  y i );   for each rank from  1  to  k  there is at least one military man with this rank.  Input The first line contains three integers  n ,  m  and  k  ( 1\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ,  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ,  1\u2009\u2264\u2009 k \u2009\u2264\u20092\u00b710 5 ) \u2014 number of military men in the Berland army, number of orders and number of ranks. The second line contains  n  integers  r 1 ,\u2009 r 2 ,\u2009...,\u2009 r n , where  r i \u2009>\u20090  (in this case  1\u2009\u2264\u2009 r i \u2009\u2264\u2009 k ) means that the  i -th military man has been already assigned the rank  r i ;  r i \u2009=\u20090  means the  i -th military man doesn't have a rank yet. The following  m  lines contain orders one per line. Each order is described with a line containing two integers  x i ,  y i  ( 1\u2009\u2264\u2009 x i ,\u2009 y i \u2009\u2264\u2009 n ,  x i \u2009\u2260\u2009 y i ). This line means that the  i -th order was given by the military man  x i  to the military man  y i . For each pair  ( x ,\u2009 y )  of military men there could be several orders from  x  to  y . Output Print  n  integers, where the  i -th number is the rank of the  i -th military man. If there are many solutions, print any of them. If there is no solution, print the only number  -1 . Examples Input 5 3 3 0 3 0 0 2 2 4 3 4 3 5 Output 1 3 3 2 2  Input 7 6 5 0 4 5 4 1 0 0 6 1 3 6 3 1 7 5 7 1 7 4 Output 2 4 5 4 1 3 5  Input 2 2 2 2 1 1 2 2 1 Output -1 B. Berland Army time limit per test 3 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  military men in the Berland army. Some of them have given orders to other military men by now. Given  m  pairs ( x i ,  y i ), meaning that the military man  x i  gave the  i -th order to another military man  y i . It is time for reform! The Berland Ministry of Defence plans to introduce ranks in the Berland army. Each military man should be assigned a rank \u2014 integer number between  1  and  k , inclusive. Some of them have been already assigned a rank, but the rest of them should get a rank soon. Help the ministry to assign ranks to the rest of the army so that:    for each of  m  orders it is true that the rank of a person giving the order (military man  x i ) is strictly greater than the rank of a person receiving the order (military man  y i );   for each rank from  1  to  k  there is at least one military man with this rank.  Input The first line contains three integers  n ,  m  and  k  ( 1\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ,  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ,  1\u2009\u2264\u2009 k \u2009\u2264\u20092\u00b710 5 ) \u2014 number of military men in the Berland army, number of orders and number of ranks. The second line contains  n  integers  r 1 ,\u2009 r 2 ,\u2009...,\u2009 r n , where  r i \u2009>\u20090  (in this case  1\u2009\u2264\u2009 r i \u2009\u2264\u2009 k ) means that the  i -th military man has been already assigned the rank  r i ;  r i \u2009=\u20090  means the  i -th military man doesn't have a rank yet. The following  m  lines contain orders one per line. Each order is described with a line containing two integers  x i ,  y i  ( 1\u2009\u2264\u2009 x i ,\u2009 y i \u2009\u2264\u2009 n ,  x i \u2009\u2260\u2009 y i ). This line means that the  i -th order was given by the military man  x i  to the military man  y i . For each pair  ( x ,\u2009 y )  of military men there could be several orders from  x  to  y . Output Print  n  integers, where the  i -th number is the rank of the  i -th military man. If there are many solutions, print any of them. If there is no solution, print the only number  -1 . Examples Input 5 3 3 0 3 0 0 2 2 4 3 4 3 5 Output 1 3 3 2 2  Input 7 6 5 0 4 5 4 1 0 0 6 1 3 6 3 1 7 5 7 1 7 4 Output 2 4 5 4 1 3 5  Input 2 2 2 2 1 1 2 2 1 Output -1 B. Berland Army time limit per test 3 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  military men in the Berland army. Some of them have given orders to other military men by now. Given  m  pairs ( x i ,  y i ), meaning that the military man  x i  gave the  i -th order to another military man  y i . It is time for reform! The Berland Ministry of Defence plans to introduce ranks in the Berland army. Each military man should be assigned a rank \u2014 integer number between  1  and  k , inclusive. Some of them have been already assigned a rank, but the rest of them should get a rank soon. Help the ministry to assign ranks to the rest of the army so that:    for each of  m  orders it is true that the rank of a person giving the order (military man  x i ) is strictly greater than the rank of a person receiving the order (military man  y i );   for each rank from  1  to  k  there is at least one military man with this rank.  Input The first line contains three integers  n ,  m  and  k  ( 1\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ,  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ,  1\u2009\u2264\u2009 k \u2009\u2264\u20092\u00b710 5 ) \u2014 number of military men in the Berland army, number of orders and number of ranks. The second line contains  n  integers  r 1 ,\u2009 r 2 ,\u2009...,\u2009 r n , where  r i \u2009>\u20090  (in this case  1\u2009\u2264\u2009 r i \u2009\u2264\u2009 k ) means that the  i -th military man has been already assigned the rank  r i ;  r i \u2009=\u20090  means the  i -th military man doesn't have a rank yet. The following  m  lines contain orders one per line. Each order is described with a line containing two integers  x i ,  y i  ( 1\u2009\u2264\u2009 x i ,\u2009 y i \u2009\u2264\u2009 n ,  x i \u2009\u2260\u2009 y i ). This line means that the  i -th order was given by the military man  x i  to the military man  y i . For each pair  ( x ,\u2009 y )  of military men there could be several orders from  x  to  y . Output Print  n  integers, where the  i -th number is the rank of the  i -th military man. If there are many solutions, print any of them. If there is no solution, print the only number  -1 . Examples Input 5 3 3 0 3 0 0 2 2 4 3 4 3 5 Output 1 3 3 2 2  Input 7 6 5 0 4 5 4 1 0 0 6 1 3 6 3 1 7 5 7 1 7 4 Output 2 4 5 4 1 3 5  Input 2 2 2 2 1 1 2 2 1 Output -1 B. Berland Army time limit per test 3 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  military men in the Berland army. Some of them have given orders to other military men by now. Given  m  pairs ( x i ,  y i ), meaning that the military man  x i  gave the  i -th order to another military man  y i . It is time for reform! The Berland Ministry of Defence plans to introduce ranks in the Berland army. Each military man should be assigned a rank \u2014 integer number between  1  and  k , inclusive. Some of them have been already assigned a rank, but the rest of them should get a rank soon. Help the ministry to assign ranks to the rest of the army so that:    for each of  m  orders it is true that the rank of a person giving the order (military man  x i ) is strictly greater than the rank of a person receiving the order (military man  y i );   for each rank from  1  to  k  there is at least one military man with this rank.  Input The first line contains three integers  n ,  m  and  k  ( 1\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ,  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ,  1\u2009\u2264\u2009 k \u2009\u2264\u20092\u00b710 5 ) \u2014 number of military men in the Berland army, number of orders and number of ranks. The second line contains  n  integers  r 1 ,\u2009 r 2 ,\u2009...,\u2009 r n , where  r i \u2009>\u20090  (in this case  1\u2009\u2264\u2009 r i \u2009\u2264\u2009 k ) means that the  i -th military man has been already assigned the rank  r i ;  r i \u2009=\u20090  means the  i -th military man doesn't have a rank yet. The following  m  lines contain orders one per line. Each order is described with a line containing two integers  x i ,  y i  ( 1\u2009\u2264\u2009 x i ,\u2009 y i \u2009\u2264\u2009 n ,  x i \u2009\u2260\u2009 y i ). This line means that the  i -th order was given by the military man  x i  to the military man  y i . For each pair  ( x ,\u2009 y )  of military men there could be several orders from  x  to  y . Output Print  n  integers, where the  i -th number is the rank of the  i -th military man. If there are many solutions, print any of them. If there is no solution, print the only number  -1 . Examples Input 5 3 3 0 3 0 0 2 2 4 3 4 3 5 Output 1 3 3 2 2  Input 7 6 5 0 4 5 4 1 0 0 6 1 3 6 3 1 7 5 7 1 7 4 Output 2 4 5 4 1 3 5  Input 2 2 2 2 1 1 2 2 1 Output -1 B. Berland Army time limit per test 3 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  military men in the Berland army. Some of them have given orders to other military men by now. Given  m  pairs ( x i ,  y i ), meaning that the military man  x i  gave the  i -th order to another military man  y i . It is time for reform! The Berland Ministry of Defence plans to introduce ranks in the Berland army. Each military man should be assigned a rank \u2014 integer number between  1  and  k , inclusive. Some of them have been already assigned a rank, but the rest of them should get a rank soon. Help the ministry to assign ranks to the rest of the army so that:    for each of  m  orders it is true that the rank of a person giving the order (military man  x i ) is strictly greater than the rank of a person receiving the order (military man  y i );   for each rank from  1  to  k  there is at least one military man with this rank.  Input The first line contains three integers  n ,  m  and  k  ( 1\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ,  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ,  1\u2009\u2264\u2009 k \u2009\u2264\u20092\u00b710 5 ) \u2014 number of military men in the Berland army, number of orders and number of ranks. The second line contains  n  integers  r 1 ,\u2009 r 2 ,\u2009...,\u2009 r n , where  r i \u2009>\u20090  (in this case  1\u2009\u2264\u2009 r i \u2009\u2264\u2009 k ) means that the  i -th military man has been already assigned the rank  r i ;  r i \u2009=\u20090  means the  i -th military man doesn't have a rank yet. The following  m  lines contain orders one per line. Each order is described with a line containing two integers  x i ,  y i  ( 1\u2009\u2264\u2009 x i ,\u2009 y i \u2009\u2264\u2009 n ,  x i \u2009\u2260\u2009 y i ). This line means that the  i -th order was given by the military man  x i  to the military man  y i . For each pair  ( x ,\u2009 y )  of military men there could be several orders from  x  to  y . Output Print  n  integers, where the  i -th number is the rank of the  i -th military man. If there are many solutions, print any of them. If there is no solution, print the only number  -1 . Examples Input 5 3 3 0 3 0 0 2 2 4 3 4 3 5 Output 1 3 3 2 2  Input 7 6 5 0 4 5 4 1 0 0 6 1 3 6 3 1 7 5 7 1 7 4 Output 2 4 5 4 1 3 5  Input 2 2 2 2 1 1 2 2 1 Output -1 B. Berland Army time limit per test 3 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  military men in the Berland army. Some of them have given orders to other military men by now. Given  m  pairs ( x i ,  y i ), meaning that the military man  x i  gave the  i -th order to another military man  y i . It is time for reform! The Berland Ministry of Defence plans to introduce ranks in the Berland army. Each military man should be assigned a rank \u2014 integer number between  1  and  k , inclusive. Some of them have been already assigned a rank, but the rest of them should get a rank soon. Help the ministry to assign ranks to the rest of the army so that:    for each of  m  orders it is true that the rank of a person giving the order (military man  x i ) is strictly greater than the rank of a person receiving the order (military man  y i );   for each rank from  1  to  k  there is at least one military man with this rank.  Input The first line contains three integers  n ,  m  and  k  ( 1\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ,  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ,  1\u2009\u2264\u2009 k \u2009\u2264\u20092\u00b710 5 ) \u2014 number of military men in the Berland army, number of orders and number of ranks. The second line contains  n  integers  r 1 ,\u2009 r 2 ,\u2009...,\u2009 r n , where  r i \u2009>\u20090  (in this case  1\u2009\u2264\u2009 r i \u2009\u2264\u2009 k ) means that the  i -th military man has been already assigned the rank  r i ;  r i \u2009=\u20090  means the  i -th military man doesn't have a rank yet. The following  m  lines contain orders one per line. Each order is described with a line containing two integers  x i ,  y i  ( 1\u2009\u2264\u2009 x i ,\u2009 y i \u2009\u2264\u2009 n ,  x i \u2009\u2260\u2009 y i ). This line means that the  i -th order was given by the military man  x i  to the military man  y i . For each pair  ( x ,\u2009 y )  of military men there could be several orders from  x  to  y . Output Print  n  integers, where the  i -th number is the rank of the  i -th military man. If there are many solutions, print any of them. If there is no solution, print the only number  -1 . Examples Input 5 3 3 0 3 0 0 2 2 4 3 4 3 5 Output 1 3 3 2 2  Input 7 6 5 0 4 5 4 1 0 0 6 1 3 6 3 1 7 5 7 1 7 4 Output 2 4 5 4 1 3 5  Input 2 2 2 2 1 1 2 2 1 Output -1 B. Berland Army time limit per test 3 seconds memory limit per test 256 megabytes input standard input output standard output There are  n  military men in the Berland army. Some of them have given orders to other military men by now. Given  m  pairs ( x i ,  y i ), meaning that the military man  x i  gave the  i -th order to another military man  y i . It is time for reform! The Berland Ministry of Defence plans to introduce ranks in the Berland army. Each military man should be assigned a rank \u2014 integer number between  1  and  k , inclusive. Some of them have been already assigned a rank, but the rest of them should get a rank soon. Help the ministry to assign ranks to the rest of the army so that:    for each of  m  orders it is true that the rank of a person giving the order (military man  x i ) is strictly greater than the rank of a person receiving the order (military man  y i );   for each rank from  1  to  k  there is at least one military man with this rank.  Input The first line contains three integers  n ,  m  and  k  ( 1\u2009\u2264\u2009 n \u2009\u2264\u20092\u00b710 5 ,  0\u2009\u2264\u2009 m \u2009\u2264\u20092\u00b710 5 ,  1\u2009\u2264\u2009 k \u2009\u2264\u20092\u00b710 5 ) \u2014 number of military men in the Berland army, number of orders and number of ranks. The second line contains  n  integers  r 1 ,\u2009 r 2 ,\u2009...,\u2009 r n , where  r i \u2009>\u20090  (in this case  1\u2009\u2264\u2009 r i \u2009\u2264\u2009 k ) means that the  i -th military man has been already assigned the rank  r i ;  r i \u2009=\u20090  means the  i -th military man doesn't have a rank yet. The following  m  lines contain orders one per line. Each order is described with a line containing two integers  x i ,  y i  ( 1\u2009\u2264\u2009 x i ,\u2009 y i \u2009\u2264\u2009 n ,  x i \u2009\u2260\u2009 y i ). This line means that the  i -th order was given by the military man  x i  to the military man  y i . For each pair  ( x ,\u2009 y )  of military men there could be several orders from  x  to  y . Output Print  n  integers, where the  i -th number is the rank of the  i -th military man. If there are many solutions, print any of them. If there is no solution, print the only number  -1 . Examples Input 5 3 3 0 3 0 0 2 2 4 3 4 3 5 Output 1 3 3 2 2  Input 7 6 5 0 4 5 4 1 0 0 6 1 3 6 3 1 7 5 7 1 7 4 Output 2 4 5 4 1 3 5  Input 2 2 2 2 1 1 2 2 1 Output -1"}