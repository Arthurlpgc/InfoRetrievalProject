{"title": "Bertown Subway", "time-limit": 1000, "memory-limit": 256, "props": {"Transport Law ": "    For each ", "Server time": "  Dec"}, "statement": "C. Bertown Subway time limit per test 1 second memory limit per test 256 megabytes input standard input output standard output The construction of subway in Bertown is almost finished! The President of Berland will visit this city soon to look at the new subway himself. There are  n  stations in the subway. It was built according to the  Bertown Transport Law :    For each station  i  there exists exactly one train that goes from this station. Its destination station is  p i , possibly  p i \u2009=\u2009 i ;   For each station  i  there exists exactly one station  j  such that  p j \u2009=\u2009 i .  The President will consider the  convenience  of subway after visiting it. The  convenience  is the number of ordered pairs  ( x ,\u2009 y )  such that person can start at station  x  and, after taking some subway trains (possibly zero), arrive at station  y  ( 1\u2009\u2264\u2009 x ,\u2009 y \u2009\u2264\u2009 n ). The mayor of Bertown thinks that if the subway is not  convenient  enough, then the President might consider installing a new mayor (and, of course, the current mayor doesn't want it to happen). Before President visits the city mayor has enough time to rebuild some paths of subway, thus changing the values of  p i  for  not more than two subway stations . Of course, breaking the  Bertown Transport Law  is really bad, so the subway must be built according to the  Law  even after changes. The mayor wants to do these changes in such a way that the  convenience  of the subway is maximized. Help him to calculate the maximum possible  convenience  he can get!  Input The first line contains one integer number  n  ( 1\u2009\u2264\u2009 n \u2009\u2264\u2009100000 ) \u2014 the number of stations. The second line contains  n  integer numbers  p 1 ,  p 2 , ...,  p n  ( 1\u2009\u2264\u2009 p i \u2009\u2264\u2009 n ) \u2014 the current structure of the subway. All these numbers are distinct. Output Print one number \u2014 the maximum possible value of  convenience . Examples Input 3 2 1 3 Output 9 Input 5 1 5 4 3 2 Output 17 Note In the first example the mayor can change  p 2  to  3  and  p 3  to  1 , so there will be  9  pairs:  (1,\u20091) ,  (1,\u20092) ,  (1,\u20093) ,  (2,\u20091) ,  (2,\u20092) ,  (2,\u20093) ,  (3,\u20091) ,  (3,\u20092) ,  (3,\u20093) . In the second example the mayor can change  p 2  to  4  and  p 3  to  5 . C. Bertown Subway time limit per test 1 second memory limit per test 256 megabytes input standard input output standard output The construction of subway in Bertown is almost finished! The President of Berland will visit this city soon to look at the new subway himself. There are  n  stations in the subway. It was built according to the  Bertown Transport Law :    For each station  i  there exists exactly one train that goes from this station. Its destination station is  p i , possibly  p i \u2009=\u2009 i ;   For each station  i  there exists exactly one station  j  such that  p j \u2009=\u2009 i .  The President will consider the  convenience  of subway after visiting it. The  convenience  is the number of ordered pairs  ( x ,\u2009 y )  such that person can start at station  x  and, after taking some subway trains (possibly zero), arrive at station  y  ( 1\u2009\u2264\u2009 x ,\u2009 y \u2009\u2264\u2009 n ). The mayor of Bertown thinks that if the subway is not  convenient  enough, then the President might consider installing a new mayor (and, of course, the current mayor doesn't want it to happen). Before President visits the city mayor has enough time to rebuild some paths of subway, thus changing the values of  p i  for  not more than two subway stations . Of course, breaking the  Bertown Transport Law  is really bad, so the subway must be built according to the  Law  even after changes. The mayor wants to do these changes in such a way that the  convenience  of the subway is maximized. Help him to calculate the maximum possible  convenience  he can get!  Input The first line contains one integer number  n  ( 1\u2009\u2264\u2009 n \u2009\u2264\u2009100000 ) \u2014 the number of stations. The second line contains  n  integer numbers  p 1 ,  p 2 , ...,  p n  ( 1\u2009\u2264\u2009 p i \u2009\u2264\u2009 n ) \u2014 the current structure of the subway. All these numbers are distinct. Output Print one number \u2014 the maximum possible value of  convenience . Examples Input 3 2 1 3 Output 9 Input 5 1 5 4 3 2 Output 17 Note In the first example the mayor can change  p 2  to  3  and  p 3  to  1 , so there will be  9  pairs:  (1,\u20091) ,  (1,\u20092) ,  (1,\u20093) ,  (2,\u20091) ,  (2,\u20092) ,  (2,\u20093) ,  (3,\u20091) ,  (3,\u20092) ,  (3,\u20093) . In the second example the mayor can change  p 2  to  4  and  p 3  to  5 . C. Bertown Subway time limit per test 1 second memory limit per test 256 megabytes input standard input output standard output The construction of subway in Bertown is almost finished! The President of Berland will visit this city soon to look at the new subway himself. There are  n  stations in the subway. It was built according to the  Bertown Transport Law :    For each station  i  there exists exactly one train that goes from this station. Its destination station is  p i , possibly  p i \u2009=\u2009 i ;   For each station  i  there exists exactly one station  j  such that  p j \u2009=\u2009 i .  The President will consider the  convenience  of subway after visiting it. The  convenience  is the number of ordered pairs  ( x ,\u2009 y )  such that person can start at station  x  and, after taking some subway trains (possibly zero), arrive at station  y  ( 1\u2009\u2264\u2009 x ,\u2009 y \u2009\u2264\u2009 n ). The mayor of Bertown thinks that if the subway is not  convenient  enough, then the President might consider installing a new mayor (and, of course, the current mayor doesn't want it to happen). Before President visits the city mayor has enough time to rebuild some paths of subway, thus changing the values of  p i  for  not more than two subway stations . Of course, breaking the  Bertown Transport Law  is really bad, so the subway must be built according to the  Law  even after changes. The mayor wants to do these changes in such a way that the  convenience  of the subway is maximized. Help him to calculate the maximum possible  convenience  he can get!  Input The first line contains one integer number  n  ( 1\u2009\u2264\u2009 n \u2009\u2264\u2009100000 ) \u2014 the number of stations. The second line contains  n  integer numbers  p 1 ,  p 2 , ...,  p n  ( 1\u2009\u2264\u2009 p i \u2009\u2264\u2009 n ) \u2014 the current structure of the subway. All these numbers are distinct. Output Print one number \u2014 the maximum possible value of  convenience . Examples Input 3 2 1 3 Output 9 Input 5 1 5 4 3 2 Output 17 Note In the first example the mayor can change  p 2  to  3  and  p 3  to  1 , so there will be  9  pairs:  (1,\u20091) ,  (1,\u20092) ,  (1,\u20093) ,  (2,\u20091) ,  (2,\u20092) ,  (2,\u20093) ,  (3,\u20091) ,  (3,\u20092) ,  (3,\u20093) . In the second example the mayor can change  p 2  to  4  and  p 3  to  5 . C. Bertown Subway time limit per test 1 second memory limit per test 256 megabytes input standard input output standard output The construction of subway in Bertown is almost finished! The President of Berland will visit this city soon to look at the new subway himself. There are  n  stations in the subway. It was built according to the  Bertown Transport Law :    For each station  i  there exists exactly one train that goes from this station. Its destination station is  p i , possibly  p i \u2009=\u2009 i ;   For each station  i  there exists exactly one station  j  such that  p j \u2009=\u2009 i .  The President will consider the  convenience  of subway after visiting it. The  convenience  is the number of ordered pairs  ( x ,\u2009 y )  such that person can start at station  x  and, after taking some subway trains (possibly zero), arrive at station  y  ( 1\u2009\u2264\u2009 x ,\u2009 y \u2009\u2264\u2009 n ). The mayor of Bertown thinks that if the subway is not  convenient  enough, then the President might consider installing a new mayor (and, of course, the current mayor doesn't want it to happen). Before President visits the city mayor has enough time to rebuild some paths of subway, thus changing the values of  p i  for  not more than two subway stations . Of course, breaking the  Bertown Transport Law  is really bad, so the subway must be built according to the  Law  even after changes. The mayor wants to do these changes in such a way that the  convenience  of the subway is maximized. Help him to calculate the maximum possible  convenience  he can get!  Input The first line contains one integer number  n  ( 1\u2009\u2264\u2009 n \u2009\u2264\u2009100000 ) \u2014 the number of stations. The second line contains  n  integer numbers  p 1 ,  p 2 , ...,  p n  ( 1\u2009\u2264\u2009 p i \u2009\u2264\u2009 n ) \u2014 the current structure of the subway. All these numbers are distinct. Output Print one number \u2014 the maximum possible value of  convenience . Examples Input 3 2 1 3 Output 9 Input 5 1 5 4 3 2 Output 17 Note In the first example the mayor can change  p 2  to  3  and  p 3  to  1 , so there will be  9  pairs:  (1,\u20091) ,  (1,\u20092) ,  (1,\u20093) ,  (2,\u20091) ,  (2,\u20092) ,  (2,\u20093) ,  (3,\u20091) ,  (3,\u20092) ,  (3,\u20093) . In the second example the mayor can change  p 2  to  4  and  p 3  to  5 . C. Bertown Subway time limit per test 1 second memory limit per test 256 megabytes input standard input output standard output The construction of subway in Bertown is almost finished! The President of Berland will visit this city soon to look at the new subway himself. There are  n  stations in the subway. It was built according to the  Bertown Transport Law :    For each station  i  there exists exactly one train that goes from this station. Its destination station is  p i , possibly  p i \u2009=\u2009 i ;   For each station  i  there exists exactly one station  j  such that  p j \u2009=\u2009 i .  The President will consider the  convenience  of subway after visiting it. The  convenience  is the number of ordered pairs  ( x ,\u2009 y )  such that person can start at station  x  and, after taking some subway trains (possibly zero), arrive at station  y  ( 1\u2009\u2264\u2009 x ,\u2009 y \u2009\u2264\u2009 n ). The mayor of Bertown thinks that if the subway is not  convenient  enough, then the President might consider installing a new mayor (and, of course, the current mayor doesn't want it to happen). Before President visits the city mayor has enough time to rebuild some paths of subway, thus changing the values of  p i  for  not more than two subway stations . Of course, breaking the  Bertown Transport Law  is really bad, so the subway must be built according to the  Law  even after changes. The mayor wants to do these changes in such a way that the  convenience  of the subway is maximized. Help him to calculate the maximum possible  convenience  he can get!  Input The first line contains one integer number  n  ( 1\u2009\u2264\u2009 n \u2009\u2264\u2009100000 ) \u2014 the number of stations. The second line contains  n  integer numbers  p 1 ,  p 2 , ...,  p n  ( 1\u2009\u2264\u2009 p i \u2009\u2264\u2009 n ) \u2014 the current structure of the subway. All these numbers are distinct. Output Print one number \u2014 the maximum possible value of  convenience . Examples Input 3 2 1 3 Output 9 Input 5 1 5 4 3 2 Output 17 Note In the first example the mayor can change  p 2  to  3  and  p 3  to  1 , so there will be  9  pairs:  (1,\u20091) ,  (1,\u20092) ,  (1,\u20093) ,  (2,\u20091) ,  (2,\u20092) ,  (2,\u20093) ,  (3,\u20091) ,  (3,\u20092) ,  (3,\u20093) . In the second example the mayor can change  p 2  to  4  and  p 3  to  5 . C. Bertown Subway time limit per test 1 second memory limit per test 256 megabytes input standard input output standard output The construction of subway in Bertown is almost finished! The President of Berland will visit this city soon to look at the new subway himself. There are  n  stations in the subway. It was built according to the  Bertown Transport Law :    For each station  i  there exists exactly one train that goes from this station. Its destination station is  p i , possibly  p i \u2009=\u2009 i ;   For each station  i  there exists exactly one station  j  such that  p j \u2009=\u2009 i .  The President will consider the  convenience  of subway after visiting it. The  convenience  is the number of ordered pairs  ( x ,\u2009 y )  such that person can start at station  x  and, after taking some subway trains (possibly zero), arrive at station  y  ( 1\u2009\u2264\u2009 x ,\u2009 y \u2009\u2264\u2009 n ). The mayor of Bertown thinks that if the subway is not  convenient  enough, then the President might consider installing a new mayor (and, of course, the current mayor doesn't want it to happen). Before President visits the city mayor has enough time to rebuild some paths of subway, thus changing the values of  p i  for  not more than two subway stations . Of course, breaking the  Bertown Transport Law  is really bad, so the subway must be built according to the  Law  even after changes. The mayor wants to do these changes in such a way that the  convenience  of the subway is maximized. Help him to calculate the maximum possible  convenience  he can get!  Input The first line contains one integer number  n  ( 1\u2009\u2264\u2009 n \u2009\u2264\u2009100000 ) \u2014 the number of stations. The second line contains  n  integer numbers  p 1 ,  p 2 , ...,  p n  ( 1\u2009\u2264\u2009 p i \u2009\u2264\u2009 n ) \u2014 the current structure of the subway. All these numbers are distinct. Output Print one number \u2014 the maximum possible value of  convenience . Examples Input 3 2 1 3 Output 9 Input 5 1 5 4 3 2 Output 17 Note In the first example the mayor can change  p 2  to  3  and  p 3  to  1 , so there will be  9  pairs:  (1,\u20091) ,  (1,\u20092) ,  (1,\u20093) ,  (2,\u20091) ,  (2,\u20092) ,  (2,\u20093) ,  (3,\u20091) ,  (3,\u20092) ,  (3,\u20093) . In the second example the mayor can change  p 2  to  4  and  p 3  to  5 . C. Bertown Subway time limit per test 1 second memory limit per test 256 megabytes input standard input output standard output The construction of subway in Bertown is almost finished! The President of Berland will visit this city soon to look at the new subway himself. There are  n  stations in the subway. It was built according to the  Bertown Transport Law :    For each station  i  there exists exactly one train that goes from this station. Its destination station is  p i , possibly  p i \u2009=\u2009 i ;   For each station  i  there exists exactly one station  j  such that  p j \u2009=\u2009 i .  The President will consider the  convenience  of subway after visiting it. The  convenience  is the number of ordered pairs  ( x ,\u2009 y )  such that person can start at station  x  and, after taking some subway trains (possibly zero), arrive at station  y  ( 1\u2009\u2264\u2009 x ,\u2009 y \u2009\u2264\u2009 n ). The mayor of Bertown thinks that if the subway is not  convenient  enough, then the President might consider installing a new mayor (and, of course, the current mayor doesn't want it to happen). Before President visits the city mayor has enough time to rebuild some paths of subway, thus changing the values of  p i  for  not more than two subway stations . Of course, breaking the  Bertown Transport Law  is really bad, so the subway must be built according to the  Law  even after changes. The mayor wants to do these changes in such a way that the  convenience  of the subway is maximized. Help him to calculate the maximum possible  convenience  he can get!  Input The first line contains one integer number  n  ( 1\u2009\u2264\u2009 n \u2009\u2264\u2009100000 ) \u2014 the number of stations. The second line contains  n  integer numbers  p 1 ,  p 2 , ...,  p n  ( 1\u2009\u2264\u2009 p i \u2009\u2264\u2009 n ) \u2014 the current structure of the subway. All these numbers are distinct. Output Print one number \u2014 the maximum possible value of  convenience . Examples Input 3 2 1 3 Output 9 Input 5 1 5 4 3 2 Output 17 Note In the first example the mayor can change  p 2  to  3  and  p 3  to  1 , so there will be  9  pairs:  (1,\u20091) ,  (1,\u20092) ,  (1,\u20093) ,  (2,\u20091) ,  (2,\u20092) ,  (2,\u20093) ,  (3,\u20091) ,  (3,\u20092) ,  (3,\u20093) . In the second example the mayor can change  p 2  to  4  and  p 3  to  5 . C. Bertown Subway time limit per test 1 second memory limit per test 256 megabytes input standard input output standard output The construction of subway in Bertown is almost finished! The President of Berland will visit this city soon to look at the new subway himself. There are  n  stations in the subway. It was built according to the  Bertown Transport Law :    For each station  i  there exists exactly one train that goes from this station. Its destination station is  p i , possibly  p i \u2009=\u2009 i ;   For each station  i  there exists exactly one station  j  such that  p j \u2009=\u2009 i .  The President will consider the  convenience  of subway after visiting it. The  convenience  is the number of ordered pairs  ( x ,\u2009 y )  such that person can start at station  x  and, after taking some subway trains (possibly zero), arrive at station  y  ( 1\u2009\u2264\u2009 x ,\u2009 y \u2009\u2264\u2009 n ). The mayor of Bertown thinks that if the subway is not  convenient  enough, then the President might consider installing a new mayor (and, of course, the current mayor doesn't want it to happen). Before President visits the city mayor has enough time to rebuild some paths of subway, thus changing the values of  p i  for  not more than two subway stations . Of course, breaking the  Bertown Transport Law  is really bad, so the subway must be built according to the  Law  even after changes. The mayor wants to do these changes in such a way that the  convenience  of the subway is maximized. Help him to calculate the maximum possible  convenience  he can get!  Input The first line contains one integer number  n  ( 1\u2009\u2264\u2009 n \u2009\u2264\u2009100000 ) \u2014 the number of stations. The second line contains  n  integer numbers  p 1 ,  p 2 , ...,  p n  ( 1\u2009\u2264\u2009 p i \u2009\u2264\u2009 n ) \u2014 the current structure of the subway. All these numbers are distinct. Output Print one number \u2014 the maximum possible value of  convenience . Examples Input 3 2 1 3 Output 9 Input 5 1 5 4 3 2 Output 17 Note In the first example the mayor can change  p 2  to  3  and  p 3  to  1 , so there will be  9  pairs:  (1,\u20091) ,  (1,\u20092) ,  (1,\u20093) ,  (2,\u20091) ,  (2,\u20092) ,  (2,\u20093) ,  (3,\u20091) ,  (3,\u20092) ,  (3,\u20093) . In the second example the mayor can change  p 2  to  4  and  p 3  to  5 . C. Bertown Subway time limit per test 1 second memory limit per test 256 megabytes input standard input output standard output The construction of subway in Bertown is almost finished! The President of Berland will visit this city soon to look at the new subway himself. There are  n  stations in the subway. It was built according to the  Bertown Transport Law :    For each station  i  there exists exactly one train that goes from this station. Its destination station is  p i , possibly  p i \u2009=\u2009 i ;   For each station  i  there exists exactly one station  j  such that  p j \u2009=\u2009 i .  The President will consider the  convenience  of subway after visiting it. The  convenience  is the number of ordered pairs  ( x ,\u2009 y )  such that person can start at station  x  and, after taking some subway trains (possibly zero), arrive at station  y  ( 1\u2009\u2264\u2009 x ,\u2009 y \u2009\u2264\u2009 n ). The mayor of Bertown thinks that if the subway is not  convenient  enough, then the President might consider installing a new mayor (and, of course, the current mayor doesn't want it to happen). Before President visits the city mayor has enough time to rebuild some paths of subway, thus changing the values of  p i  for  not more than two subway stations . Of course, breaking the  Bertown Transport Law  is really bad, so the subway must be built according to the  Law  even after changes. The mayor wants to do these changes in such a way that the  convenience  of the subway is maximized. Help him to calculate the maximum possible  convenience  he can get!  Input The first line contains one integer number  n  ( 1\u2009\u2264\u2009 n \u2009\u2264\u2009100000 ) \u2014 the number of stations. The second line contains  n  integer numbers  p 1 ,  p 2 , ...,  p n  ( 1\u2009\u2264\u2009 p i \u2009\u2264\u2009 n ) \u2014 the current structure of the subway. All these numbers are distinct. Output Print one number \u2014 the maximum possible value of  convenience . Examples Input 3 2 1 3 Output 9 Input 5 1 5 4 3 2 Output 17 Note In the first example the mayor can change  p 2  to  3  and  p 3  to  1 , so there will be  9  pairs:  (1,\u20091) ,  (1,\u20092) ,  (1,\u20093) ,  (2,\u20091) ,  (2,\u20092) ,  (2,\u20093) ,  (3,\u20091) ,  (3,\u20092) ,  (3,\u20093) . In the second example the mayor can change  p 2  to  4  and  p 3  to  5 . C. Bertown Subway time limit per test 1 second memory limit per test 256 megabytes input standard input output standard output The construction of subway in Bertown is almost finished! The President of Berland will visit this city soon to look at the new subway himself. There are  n  stations in the subway. It was built according to the  Bertown Transport Law :    For each station  i  there exists exactly one train that goes from this station. Its destination station is  p i , possibly  p i \u2009=\u2009 i ;   For each station  i  there exists exactly one station  j  such that  p j \u2009=\u2009 i .  The President will consider the  convenience  of subway after visiting it. The  convenience  is the number of ordered pairs  ( x ,\u2009 y )  such that person can start at station  x  and, after taking some subway trains (possibly zero), arrive at station  y  ( 1\u2009\u2264\u2009 x ,\u2009 y \u2009\u2264\u2009 n ). The mayor of Bertown thinks that if the subway is not  convenient  enough, then the President might consider installing a new mayor (and, of course, the current mayor doesn't want it to happen). Before President visits the city mayor has enough time to rebuild some paths of subway, thus changing the values of  p i  for  not more than two subway stations . Of course, breaking the  Bertown Transport Law  is really bad, so the subway must be built according to the  Law  even after changes. The mayor wants to do these changes in such a way that the  convenience  of the subway is maximized. Help him to calculate the maximum possible  convenience  he can get!  Input The first line contains one integer number  n  ( 1\u2009\u2264\u2009 n \u2009\u2264\u2009100000 ) \u2014 the number of stations. The second line contains  n  integer numbers  p 1 ,  p 2 , ...,  p n  ( 1\u2009\u2264\u2009 p i \u2009\u2264\u2009 n ) \u2014 the current structure of the subway. All these numbers are distinct. Output Print one number \u2014 the maximum possible value of  convenience . Examples Input 3 2 1 3 Output 9 Input 5 1 5 4 3 2 Output 17 Note In the first example the mayor can change  p 2  to  3  and  p 3  to  1 , so there will be  9  pairs:  (1,\u20091) ,  (1,\u20092) ,  (1,\u20093) ,  (2,\u20091) ,  (2,\u20092) ,  (2,\u20093) ,  (3,\u20091) ,  (3,\u20092) ,  (3,\u20093) . In the second example the mayor can change  p 2  to  4  and  p 3  to  5 . C. Bertown Subway time limit per test 1 second memory limit per test 256 megabytes input standard input output standard output The construction of subway in Bertown is almost finished! The President of Berland will visit this city soon to look at the new subway himself. There are  n  stations in the subway. It was built according to the  Bertown Transport Law :    For each station  i  there exists exactly one train that goes from this station. Its destination station is  p i , possibly  p i \u2009=\u2009 i ;   For each station  i  there exists exactly one station  j  such that  p j \u2009=\u2009 i .  The President will consider the  convenience  of subway after visiting it. The  convenience  is the number of ordered pairs  ( x ,\u2009 y )  such that person can start at station  x  and, after taking some subway trains (possibly zero), arrive at station  y  ( 1\u2009\u2264\u2009 x ,\u2009 y \u2009\u2264\u2009 n ). The mayor of Bertown thinks that if the subway is not  convenient  enough, then the President might consider installing a new mayor (and, of course, the current mayor doesn't want it to happen). Before President visits the city mayor has enough time to rebuild some paths of subway, thus changing the values of  p i  for  not more than two subway stations . Of course, breaking the  Bertown Transport Law  is really bad, so the subway must be built according to the  Law  even after changes. The mayor wants to do these changes in such a way that the  convenience  of the subway is maximized. Help him to calculate the maximum possible  convenience  he can get!  Input The first line contains one integer number  n  ( 1\u2009\u2264\u2009 n \u2009\u2264\u2009100000 ) \u2014 the number of stations. The second line contains  n  integer numbers  p 1 ,  p 2 , ...,  p n  ( 1\u2009\u2264\u2009 p i \u2009\u2264\u2009 n ) \u2014 the current structure of the subway. All these numbers are distinct. Output Print one number \u2014 the maximum possible value of  convenience . Examples Input 3 2 1 3 Output 9 Input 5 1 5 4 3 2 Output 17 Note In the first example the mayor can change  p 2  to  3  and  p 3  to  1 , so there will be  9  pairs:  (1,\u20091) ,  (1,\u20092) ,  (1,\u20093) ,  (2,\u20091) ,  (2,\u20092) ,  (2,\u20093) ,  (3,\u20091) ,  (3,\u20092) ,  (3,\u20093) . In the second example the mayor can change  p 2  to  4  and  p 3  to  5 ."}