                  Username: *     Password: *    Forgot Password               New User                 Site Navigation  PRACTICE Code, Compile & Run  Beginner  Easy  Medium  Hard  Challenge  Peer    COMPETE All Contests  September Cook-Off 2017  September Lunchtime 2017  September Challenge 2017    DISCUSS Forums  Blog  Wiki  Facebook  Twitter    COMMUNITY Goodies Website  SnackDown 2017  CodeChef for Schools  Host your Contest  Go for Gold  Campus Chapter    HELP Frequently Asked Questions  Rating Mechanism  CodeChef Rating (All)  CodeChef Rating (Junior)  FAQ for problem setters  Problem Setting  Tutorials  Event Calendar  Top Contributors on Discuss    ABOUT About CodeChef  Press Room  CEO's Corner  Contact Us  About Directi                Home » Practice(Medium) » Dividing into Regions      Dividing into Regions Problem Code: REGIONS                          All submissions for this problem are available. Read problems statements in Mandarin Chinese , Russian and Vietnamese as well.  ChefLand develops very fast. Recently, there were a few new cities built, so the total number of cities in ChefLand have become N .  In order to communicate, the cities are connected with N-1 bidirectional roads in such a way that there is exactly one way to get 
from one city to another. In other words, the graph with cities as nodes
 and roads as edges is a tree.  Now, the King of ChefLand thinks that the country is too big to be 
ruled by one person, so he decided to split in two parts, each of which 
will be ruled by one of two his sons. The split should be made by 
blocking one road. After doing that, there will be two connected parts 
which will be ruled by sons.  However, not every division is good. In some cases, one of the parts 
will still be very large, thus, it will be very hard for some of the 
sons to rule it. So, for every connected part, there's a value called inconvenience . The inconvenience of the part equals to the distance between two most distance cities belonging to this part.  So for every split, there are two inconvenience values that should be calculated. Please help the King to find them!  Input  The first line of the input contains an integer T denoting the number of test cases. The description of T test cases follows.  In order not to make this problem I/O related, we will give you the 
road system in the compressed form. The first and only line of the test 
case will contain six space-separated integers N, A, B, C, D, E with the following meaning:  The road system contains N cities and N-1 roads.  The i th road (1-indexed) connects the cities with the numbers i+1 and ((A + B * (i - 1)) % i) + 1 and has the length equal to (C * i + D) % E . It is guaranteed that the road system, generated this way will be connected.  Output  In order not to make this problem I/O-related, we will ask you the hash function of the answer to each test case.  The hash function is calculated this way: First, an 1-indexed sequence Q of 2(N-1) answers is created.  The (2*i-1) th term of this sequence is the smallest of the inconvenience values after removing the i th edge.  The (2*i) th term of this sequence is the greatest of the inconvenience values after removing the i th edge.  Then, the value of the hash function is a sum of Q i * (1000000 + 3) i-1 , modulo 10 9 +7 .   Constraints   1 ≤ T ≤ 10 5  2 ≤ N , sum of N ≤ 5 × 10 6  0 ≤ A, B, C, D ≤ 10 4  2 ≤ E ≤ 200   Example  Input:  2
5 1 2 3 4 5
89 189 111 34 7 200  Output:  99116027
515191750   Explanation  Example case 1. The roads are:  Road connecting cities 1 and 2 with length 2 ;  Road connecting cities 2 and 3 with length 0 ;  Road connecting cities 3 and 4 with length 3 ;  Road connecting cities 4 and 5 with length 1 .    If we remove the first road, then the inconveniences of the parts will be equal to 0 and 4 . So Q 1 = 0, Q 2 = 4 .  If we remove the second road, the inconveniences will be equal to 2 and 4 . So Q 3 = 2, Q 4 = 4 .  If we remove the third road, the inconveniences will be equal to 2 and 1 . So Q 5 = 1, Q 6 = 2 .  If we remove the fourth road, the inconveniences will be equal to 5 and 0 . So Q 7 = 0, Q 8 = 5 .  So, we've obtained the sequence Q = (0, 4, 2, 4, 1, 2, 0, 5) .  By calculating the hash function, we get 0 × 1000003 0 +4 × 1000003 1 +2 × 1000003 2 +4 × 1000003 3 +1 × 1000003 4 +2 × 1000003 5 +0 × 1000003 6 +5 × 1000003 7 mod (10 9 +7)= 5000105000947004756014371026147026557011640 mod (10 9 +7) = 99116027  Example case 2. This is just a big test case, so that you could check your solution better.     Author:  6★ xcwgf666    Tester:  null    Editorial:  http://discuss.codechef.com/problems/REGIONS    Tags:  bfs dfs memoization snckpb16 tree xcwgf666    Date Added:  8-06-2016    Time Limit:  3 secs    Source Limit:  50000 Bytes    Languages:  ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, 
CLPS, CPP 4.3.2, CPP 6.3, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, 
ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, 
PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.5, RUBY, 
SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC             All Submissions     Successful Submissions             Comments                 CodeChef is a non-commercial competitive programming community       About CodeChef  About Directi  CEO's Corner  C-Programming  Programming Languages  Contact Us   © 2009 Directi Group . All Rights Reserved. CodeChef uses SPOJ © by Sphere Research Labs In order to report copyright violations of any kind, send in an email to copyright@codechef.com       The time now is: 11:42:58 AM    Your IP: 177.98.212.249                      CodeChef - A Platform for Aspiring Programmers  CodeChef was created as a platform to help programmers make it big in the world of algorithms, computer programming and programming contests . At CodeChef we work hard to revive the geek in you by hosting a programming contest at the start of the month and another smaller programming challenge in 
the middle of the month. We also aim to have training sessions and 
discussions related to algorithms , binary search , technicalities like array size and the likes. Apart from providing a platform for programming competitions , CodeChef also has various algorithm tutorials and forum discussions to help those who are new to the world of computer programming .    Practice Section - A Place to hone your 'Computer Programming Skills'  Try your hand at one of our many practice problems and submit your solution in a language of your choice. Our programming contest judge accepts solutions in over 35+ programming languages. Preparing 
for coding contests were never this much fun! Receive points, and move 
up through the CodeChef ranks. Use our practice section to better 
prepare yourself for the multiple programming challenges that take place through-out the month on CodeChef.    Compete - Monthly Programming Contests and Cook-offs  Here is where you can show off your computer programming skills . Take part in our 10 day long monthly coding contest and the shorter format Cook-off coding contest . Put yourself up for recognition and win great prizes. Our programming contests have prizes worth up to INR 20,000 (for Indian Community), $700 (for 
Global Community) and lots more CodeChef goodies up for grabs.        Programming Tools   Online IDE  Upcoming Coding Contests  Contest Hosting  Problem Setting  CodeChef Tutorials  CodeChef Wiki     Practice Problems   Easy  Medium  Hard  Challenge  Peer  School  FAQ's     Initiatives   Go for Gold  CodeChef for Schools  Campus Chapters               Domain Registration in India and Web Hosting powered by BigRock      
